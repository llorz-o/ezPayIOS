"use strict";(self["webpackChunkez_pay"]=self["webpackChunkez_pay"]||[]).push([[5948],{35948:function(e,t,r){r.r(t),r.d(t,{default:function(){return w}});var n,o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"page bind-google-auth"},[1===e.step?[r("div",{staticClass:"tips"},[e._v(" 使用Google Authenticator扫码或输入设置密钥以绑定 ")]),r("van-image",{attrs:{id:"qrcode",src:e.authInfo.qrCodeUrl},scopedSlots:e._u([{key:"loading",fn:function(){return[r("van-loading",{attrs:{type:"spinner",size:"20"}})]},proxy:!0},{key:"error",fn:function(){return[r("van-icon",{attrs:{name:"qr-invalid"}})]},proxy:!0}],null,!1,3262582198)}),r("div",{staticClass:"copyWrapper"},[r("span",{staticClass:"key"},[e._v(e._s(e.authInfo.secret))]),r("button",{directives:[{name:"clipboard",rawName:"v-clipboard",value:e.authInfo.secret,expression:"authInfo.secret"}],staticClass:"icon copy copyBtn",on:{success:e.$root.copySuccessful}})]),r("van-button",{staticClass:"block primary next",on:{click:function(t){e.step=2}}},[e._v(" 扫码或添加密钥完成 ")]),r("div",{staticClass:"guide danger_text"},[e._v(" 如何下载、绑定谷歌身份验证器？ ")])]:[r("div",{staticClass:"tips"},[e._v(" 输入动态验证码以验证身份 ")]),r("van-password-input",{attrs:{value:e.password,focused:e.showKeyboard},on:{focus:function(t){e.showKeyboard=!0}}}),r("van-number-keyboard",{attrs:{show:e.showKeyboard},on:{blur:function(t){e.showKeyboard=!1}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),r("div",{staticClass:"guide danger_text step2"},[e._v(" 绑定后，使用钱包充值游戏平台，卖币确认转币 需要通过谷歌身份验证器验证 ")]),r("van-button",{staticClass:"block primary",on:{click:e.checkBindGoogleAuthenticator}},[e._v(" 验证 ")]),r("van-button",{staticClass:"block secondary",on:{click:function(t){e.step=1}}},[e._v(" 取消 ")])]],2)},a=[],s=r(49749),c=r(39873),u=r(7067),i=(r(83040),r(68309),r(32564),r(93126)),l=r(78396),f=r(53045),p=r(39766),d={components:(n={},(0,u.Z)(n,i.Z.name,i.Z),(0,u.Z)(n,l.Z.name,l.Z),n),data:function(){return{step:1,password:"",showKeyboard:!1,authInfo:{qrCodeUrl:"",secret:""}}},watch:{password:function(e){6===e.length&&(this.showKeyboard=!1)}},created:function(){this.$root.$emit("root:set-topbar",[])},methods:{bindGoogleAuthenticator:function(e){var t=this;return(0,c.Z)(regeneratorRuntime.mark((function r(){var n,o,a,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,(0,f.p$)({securePassword:e});case 2:n=r.sent,o=n.ok,a=n.data,c=n.msg,o?(t.authInfo=(0,s.Z)({},a||{}),t.$toast.success(c)):(t.$toast.fail(c),t.$router.back());case 7:case"end":return r.stop()}}),r)})))()},checkBindGoogleAuthenticator:function(){var e=this;return(0,c.Z)(regeneratorRuntime.mark((function t(){var r,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(6===e.password.length){t.next=2;break}return t.abrupt("return",e.$toast.fail("请输入google验证码"));case 2:return t.next=4,(0,f.t4)({safeCode:e.password,secret:e.authInfo.secret});case 4:if(r=t.sent,n=r.ok,o=r.msg,!n){t.next=14;break}return e.$toast.success(o),t.next=11,e.$root.fetchUserInfo();case 11:e.$router.back(),t.next=15;break;case 14:e.$toast.fail(o);case 15:case"end":return t.stop()}}),t)})))()}},beforeRouteEnter:function(e,t,r){r((function(e){e.$dialog({className:"common",title:"请输入资金密码",message:"为了您的账户安全，绑定谷歌验证器需要验证资金密码",confirmButtonText:"确认",beforeClose:function(){var t=(0,c.Z)(regeneratorRuntime.mark((function t(r,n){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n(),t.next=3,(0,p.x)(e);case 3:if(o=t.sent,!o||6!==o.length){t.next=10;break}return e.$root.$emit("root:set-topbar",["left-back"]),t.next=8,e.bindGoogleAuthenticator(o);case 8:t.next=13;break;case 10:if("close-by-route-change"!==o){t.next=12;break}return t.abrupt("return");case 12:setTimeout((function(){return e.$router.back()}),350);case 13:case"end":return t.stop()}}),t)})));function r(e,r){return t.apply(this,arguments)}return r}()})}))}},h=d,b=r(1001),v=(0,b.Z)(h,o,a,!1,null,null,null),w=v.exports},39766:function(e,t,r){r.d(t,{D:function(){return s},x:function(){return a}});var n=r(39873),o=(r(83040),r(41539),r(32564),r(53045)),a=function(e){return e.$toast("请输入资金密码"),new Promise((function(t,r){e.$root.showPassowordKeyboard=!0,e.$root.$once("root:global-password",function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t(r));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))},s=function(e){return e.$root.userInfo&&e.$root.userInfo.isGoogleAuthenticator?(e.$toast("请输入Google安全码"),new Promise((function(t,r){setTimeout((function(){e.$root.showPassowordKeyboard=!0,e.$root.$once("root:global-password",function(){var r=(0,n.Z)(regeneratorRuntime.mark((function r(n){var a,s,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n&&"close-by-route-change"!==n){r.next=2;break}return r.abrupt("return",t(!1));case 2:return r.next=4,(0,o.Wg)({safeCode:n});case 4:a=r.sent,s=a.ok,c=a.msg,s?t(!0):(t(!1),e.$toast.fail(c));case 8:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())}),0)}))):Promise.resolve(!0)}}}]);
//# sourceMappingURL=5948.29e5bfaa.js.map