{"version":3,"file":"js/4659.289fbc5a.js","mappings":"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","sources":["webpack://ez_pay/./src/views/user_bind_phone/index.vue?4676","webpack://ez_pay/src/views/user_bind_phone/index.vue","webpack://ez_pay/./src/views/user_bind_phone/index.vue?0de9","webpack://ez_pay/./src/views/user_bind_phone/index.vue","webpack://ez_pay/./src/apis/verify.js"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page page-user-bind-phone\"},[_c('van-form',{on:{\"submit\":_vm.onSubmit}},[_c('van-field',{attrs:{\"autocomplete\":\"new-password\",\"label\":\"手机号码\",\"maxlength\":\"11\",\"placeholder\":\"手机号\",\"type\":\"tel\"},model:{value:(_vm.form.phoneNumber),callback:function ($$v) {_vm.$set(_vm.form, \"phoneNumber\", $$v)},expression:\"form.phoneNumber\"}}),_c('van-field',{attrs:{\"autocomplete\":\"new-password\",\"label\":\"验证码\",\"placeholder\":\"短信验证码\"},scopedSlots:_vm._u([{key:\"extra\",fn:function(){return [_c('van-button',{staticClass:\"btnGetVerifyCode primary\",attrs:{\"native-type\":\"button\",\"size\":\"small\"},on:{\"click\":_vm.getSmsVerifyCode}},[(_vm.smsCountdown)?_c('van-count-down',{attrs:{\"time\":_vm.smsCountdown,\"auto-start\":\"\",\"format\":\"ss\"},on:{\"finish\":function($event){_vm.smsCountdown = 0}}}):[_vm._v(\" 获取验证码\")]],2)]},proxy:true}]),model:{value:(_vm.form.smsCode),callback:function ($$v) {_vm.$set(_vm.form, \"smsCode\", $$v)},expression:\"form.smsCode\"}}),_c('van-button',{staticClass:\"primary block\",class:{\n        disabled: !_vm.form.phoneNumber || !_vm.form.smsCode,\n      }},[_vm._v(\" 确定 \")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"page page-user-bind-phone\">\n    <van-form @submit=\"onSubmit\">\n      <van-field\n        v-model=\"form.phoneNumber\"\n        autocomplete=\"new-password\"\n        label=\"手机号码\"\n        maxlength=\"11\"\n        placeholder=\"手机号\"\n        type=\"tel\"\n      >\n      </van-field>\n      <van-field\n        v-model=\"form.smsCode\"\n        autocomplete=\"new-password\"\n        label=\"验证码\"\n        placeholder=\"短信验证码\"\n      >\n        <template #extra>\n          <van-button\n            class=\"btnGetVerifyCode primary\"\n            native-type=\"button\"\n            size=\"small\"\n            @click=\"getSmsVerifyCode\"\n          >\n            <van-count-down\n              v-if=\"smsCountdown\"\n              :time=\"smsCountdown\"\n              auto-start\n              format=\"ss\"\n              @finish=\"smsCountdown = 0\"\n            />\n            <template v-else> 获取验证码</template>\n          </van-button>\n        </template>\n      </van-field>\n\n      <van-button\n        :class=\"{\n          disabled: !form.phoneNumber || !form.smsCode,\n        }\"\n        class=\"primary block\"\n      >\n        确定\n      </van-button>\n    </van-form>\n  </div>\n</template>\n\n<script>\nimport {sendCode} from \"@/apis/verify\";\nimport {checkBindPhoneNumber} from \"@/apis/user\";\nimport Store from \"store\";\n\nexport default {\n  data() {\n    return {\n      form: {\n        phoneNumber: \"\",\n        smsCode: \"\",\n      },\n      smsCountdown: 0,\n    };\n  },\n  created() {\n    this.$root.$emit(\"root:set-topbar\", [\"left-back\"]);\n  },\n  methods: {\n    smsCount() {\n      const lastTimeSmsCodeRequest = this.$st.get(\"LAST_SMS_REQUEST\");\n      if (lastTimeSmsCodeRequest) {\n        const delay = Date.now() - Number(lastTimeSmsCodeRequest);\n        if (delay < 60) {\n          this.smsCountdown = (60 - delay) * 1000;\n        }\n      }\n    },\n    getSmsVerifyCode() {\n      if (this.smsCountdown) {\n        return;\n      }\n      sendCode({\n        phoneNumber: this.form.phoneNumber,\n        codeType: \"bindPhoneNumber\",\n      }).then(({ok, msg, data}) => {\n        if (ok) {\n          if (process.env.NODE_ENV === \"development\") {\n            this.form.smsCode = data;\n          }\n          this.$toast.success(msg);\n          this.smsCountdown = 60000;\n          this.$st.set(\"LAST_SMS_REQUEST\", Date.now());\n        } else {\n          this.$toast.fail(msg);\n        }\n      });\n    },\n    onSubmit() {\n      if (!/^1[3456789]\\d{9}$/.test(this.form.phoneNumber))\n        return this.$toast.fail(\"请输入合法的手机号码\");\n      if (this.form.smsCode === \"\") return this.$toast.fail(\"请输入短信验证码\");\n      checkBindPhoneNumber({\n        phoneNumber: this.form.phoneNumber,\n        smsCode: this.form.smsCode,\n      }).then(({ok, msg}) => {\n        if (ok) {\n          Store.set(\"USER_INFO\", 0);\n          this.$root.userInfo.isEnteredPhoneNumber = 1;\n          this.$toast.success(msg);\n          if (!this.$root.isBindPwd) {\n            this.$dialog.alert({\n              className: \"common\",\n              message: \"请绑定密码\",\n              beforeClose: (action, done) => {\n                this.$router.replace(\"/user_pay_psw\");\n                done();\n              },\n            });\n          }\n          this.$router.back();\n        } else {\n          this.$toast.fail(msg);\n        }\n      });\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.page.page-user-bind-phone {\n  .van-form {\n    .btnGetVerifyCode {\n      height: 24px;\n      width: 90px;\n      border-radius: 12px;\n      font-size: 12px;\n\n      .van-count-down {\n        color: #fff;\n        line-height: 22px;\n      }\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=31497b2b&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=31497b2b&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"31497b2b\",\n  null\n  \n)\n\nexport default component.exports","import {q} from '@/vendor/q';\n// import * as wangsu from 'wcs-js-sdk'\n// import CryptoJS from 'crypto-js'\n\nexport const getImageCode = data => q({\n  url: '/Api/Common/VerifyCode/getImageCode',\n  method: 'POST',\n  data\n})\n\nexport const checkVerifyCode = data => q({\n  url: '/Api/Common/VerifyCode/checkVerifyCodeNew',\n  method: 'POST',\n  data\n})\n\nexport const sendCode = data => q({\n  url: '/Api/Common/VerifyCode/sendCode',\n  method: 'POST',\n  data\n})\n\nexport const uploadBase64Img = data => q({\n  url: '/Api/User/UploadFile/uploadBase64Img',\n  method: 'POST',\n  data\n})\n\nexport const uploadVideo = data => q({\n  url: '/Api/User/UploadFile/uploadVideo',\n  method: 'POST',\n  data,\n})\n\nexport const uploadLargeVideo = (data, opts = {}) => q({\n  url: '/Api/User/UploadFile/uploadLargeVideo',\n  method: 'POST',\n  data,\n  opts\n})\n\nexport const uploadFileToken = data => q({\n  url: '/Api/User/UploadFile/uploadFileToken',\n  method: 'POST',\n  data,\n})\n\n// export const uploadFromWangSu = async (file, type, mediaType) => {\n//   const {ok, data, msg} = await uploadFileToken({\n//     type,\n//     mediaType\n//   })\n//   if (!ok) throw new Error(`msg:${msg},can not get sdk token`)\n//   const _uploader = wangsu.wcsUpload(file, data.token, data.uploadUrl, {\n//     timeout: 25000,\n//     retryCount: 4,\n//   })\n//   // 获取文件etag\n//   // wangsu.getEtagHash(file,res => {\n//   //   console.log(res);\n//   // })\n//   return await new Promise((resolve, reject) => {\n//     _uploader.onError = error => {\n//       console.error('wangsu upload error', error);\n//       reject({\n//         ok:false,\n//         msg: `code:${error.code},isRequestError:${error.isRequestError} message:${error.message}`\n//       })\n//     }\n//     _uploader.onComplete = res => {\n//       resolve({\n//         ok: true,\n//         msg: \"上传成功\",\n//         data: {\n//           name: data.imageUrl\n//         }\n//       })\n//     }\n//     _uploader.putFile()\n//   })\n// }\n"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","on","onSubmit","attrs","model","value","form","callback","$$v","$set","expression","scopedSlots","_u","key","fn","getSmsVerifyCode","smsCountdown","$event","_v","proxy","class","disabled","phoneNumber","smsCode","staticRenderFns","data","created","methods","smsCount","sendCode","codeType","msg","_this","checkBindPhoneNumber","Store","_this2","className","message","beforeClose","done","component","getImageCode","q","url","method","uploadLargeVideo","opts","arguments","length","undefined"],"sourceRoot":""}