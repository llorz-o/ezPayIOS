"use strict";(self["webpackChunkez_pay"]=self["webpackChunkez_pay"]||[]).push([[2537,9024],{42537:function(t,n,r){r.r(n),r.d(n,{default:function(){return h}});var e=function(){var t=this,n=t.$createElement,r=t._self._c||n;return r("div",{staticClass:"page page-qr_login"},[r("img",{attrs:{id:"qrcode",alt:"",src:""}}),r("p",[t._v("检查到新设备登录")]),r("p",[t._v("请用已绑定设备的扫码授权登录")]),r("van-button",{staticClass:"primary block",attrs:{to:{path:"/layout_auth",query:{unbind:1}},replace:""}},[t._v(" 无法扫码？解除验证码 ")])],1)},o=[],u=(r(32564),r(74916),r(15306),r(75461)),i=r(53045),c=r(95426),a=r(58509),f=r(59024),s={data:function(){return{uuid:"",loading:null}},created:function(){this.$root.$emit("root:set-topbar",["left-back"])},mounted:function(){this.createQrcode()},methods:{createQrcode:function(){var t=document.getElementById("qrcode");this.getQrCode(t)},getQrCode:function(t){var n=this;(0,i.$I)().then((function(r){var e=r.ok,o=r.data;r.msg;e?(n.uuid=o.uuid,u.toDataURL("ezpay://".concat((0,f.encode)("login?v=".concat(o.uuid)))).then((function(r){t.src=r,n.checkScanState()}))["catch"]((function(t){console.error(t),n.$dialog.confirm({message:"二维码生成失败，请刷新二维码。",className:"common",confirmButtonText:"刷新二维码",confirmButtonColor:"#6f59fe",beforeClose:function(t,r){"confirm"===t?n.createQrcode():n.$router.back(),r()}})}))):n.$dialog.confirm({message:"二维码请求失败，请刷新二维码。",className:"common",confirmButtonText:"刷新二维码",confirmButtonColor:"#6f59fe",beforeClose:function(t,r){"confirm"===t?n.createQrcode():n.$router.back(),r()}})}))},checkScanState:function(){var t=this;(0,i.MT)({uuid:this.uuid}).then((function(n){var r=n.ok,e=n.data;n.msg;if(r){if("scanned"===e.state)return null===t.loading&&(t.loading=a.Z.loading({duration:0,forbidClick:!0,message:"等待确认"})),void(t.timer=setTimeout((function(){return t.checkScanState()}),5e3));if(t.loading&&t.loading.clear(),t.loading=null,"confirm"===e.state)return clearTimeout(t.timer),t.$root.setUserInfo(e.userInfo),t.$st.set("USER_INFO",e.userInfo),t.$st.set("TOKEN",e.token),t.$root.token=e.token,(0,c.Ks)(e.token),t.$root.refreshGlobalNotices(),t.$root.loadConfig(),t.$root.loadBanks(),t.$root.loadPayments(),void t.$router.replace("/");if("canceled"===e.state)return clearTimeout(t.timer),void t.$dialog.alert({className:"common",message:"新设备登录已取消",confirmButtonColor:"#6f59fe",beforeClose:function(n,r){r(),t.$router.back()}});if("invalid"===e.state)return clearTimeout(t.timer),void t.$dialog.confirm({message:"验证已失效，请重新扫码。",confirmButtonText:"重新扫码",confirmButtonColor:"#6f59fe",className:"common",beforeClose:function(n,r){"confirm"===n?t.createQrcode():t.$router.back(),r()}});t.timer=setTimeout((function(){return t.checkScanState()}),5e3)}}))}},beforeDestroy:function(){clearTimeout(this.timer)}},l=s,d=r(1001),m=(0,d.Z)(l,e,o,!1,null,null,null),h=m.exports},59024:function(t,n,r){r.r(n),r.d(n,{Base64:function(){return q},VERSION:function(){return o},atob:function(){return R},atobPolyfill:function(){return I},btoa:function(){return v},btoaPolyfill:function(){return y},btou:function(){return E},decode:function(){return N},encode:function(){return $},encodeURI:function(){return S},encodeURL:function(){return S},extendBuiltins:function(){return L},extendString:function(){return Q},extendUint8Array:function(){return O},fromBase64:function(){return N},fromUint8Array:function(){return C},isValid:function(){return Z},toBase64:function(){return $},toUint8Array:function(){return w},utob:function(){return U},version:function(){return e}});r(47042),r(89554),r(41539),r(54747),r(24812),r(98145),r(39575),r(82472),r(92990),r(18927),r(33105),r(35035),r(74345),r(7174),r(32846),r(44731),r(77209),r(96319),r(58867),r(37789),r(33739),r(29368),r(14483),r(12056),r(3462),r(30678),r(27462),r(33824),r(55021),r(12974),r(15016),r(21249),r(74916),r(15306),r(83710),r(39714),r(69600),r(77601),r(69070);var e="3.7.2",o=e,u="function"===typeof atob,i="function"===typeof btoa,c="function"===typeof Buffer,a="function"===typeof TextDecoder?new TextDecoder:void 0,f="function"===typeof TextEncoder?new TextEncoder:void 0,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=Array.prototype.slice.call(s),d=function(t){var n={};return t.forEach((function(t,r){return n[t]=r})),n}(l),m=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,h=String.fromCharCode.bind(String),g="function"===typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t};return new Uint8Array(Array.prototype.slice.call(t,0).map(n))},b=function(t){return t.replace(/=/g,"").replace(/[+\/]/g,(function(t){return"+"==t?"-":"_"}))},p=function(t){return t.replace(/[^A-Za-z0-9\+\/]/g,"")},y=function(t){for(var n,r,e,o,u="",i=t.length%3,c=0;c<t.length;){if((r=t.charCodeAt(c++))>255||(e=t.charCodeAt(c++))>255||(o=t.charCodeAt(c++))>255)throw new TypeError("invalid character found");n=r<<16|e<<8|o,u+=l[n>>18&63]+l[n>>12&63]+l[n>>6&63]+l[63&n]}return i?u.slice(0,i-3)+"===".substring(i):u},v=i?function(t){return btoa(t)}:c?function(t){return Buffer.from(t,"binary").toString("base64")}:y,A=c?function(t){return Buffer.from(t).toString("base64")}:function(t){for(var n=4096,r=[],e=0,o=t.length;e<o;e+=n)r.push(h.apply(null,t.subarray(e,e+n)));return v(r.join(""))},C=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n?b(A(t)):A(t)},B=function(t){if(t.length<2){var n=t.charCodeAt(0);return n<128?t:n<2048?h(192|n>>>6)+h(128|63&n):h(224|n>>>12&15)+h(128|n>>>6&63)+h(128|63&n)}n=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return h(240|n>>>18&7)+h(128|n>>>12&63)+h(128|n>>>6&63)+h(128|63&n)},x=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,U=function(t){return t.replace(x,B)},k=c?function(t){return Buffer.from(t,"utf8").toString("base64")}:f?function(t){return A(f.encode(t))}:function(t){return v(U(t))},$=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n?b(k(t)):k(t)},S=function(t){return $(t,!0)},T=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,F=function(t){switch(t.length){case 4:var n=(7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3),r=n-65536;return h(55296+(r>>>10))+h(56320+(1023&r));case 3:return h((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return h((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},E=function(t){return t.replace(T,F)},I=function(t){if(t=t.replace(/\s+/g,""),!m.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(3&t.length));for(var n,r,e,o="",u=0;u<t.length;)n=d[t.charAt(u++)]<<18|d[t.charAt(u++)]<<12|(r=d[t.charAt(u++)])<<6|(e=d[t.charAt(u++)]),o+=64===r?h(n>>16&255):64===e?h(n>>16&255,n>>8&255):h(n>>16&255,n>>8&255,255&n);return o},R=u?function(t){return atob(p(t))}:c?function(t){return Buffer.from(t,"base64").toString("binary")}:I,_=c?function(t){return g(Buffer.from(t,"base64"))}:function(t){return g(R(t),(function(t){return t.charCodeAt(0)}))},w=function(t){return _(D(t))},z=c?function(t){return Buffer.from(t,"base64").toString("utf8")}:a?function(t){return a.decode(_(t))}:function(t){return E(R(t))},D=function(t){return p(t.replace(/[-_]/g,(function(t){return"-"==t?"+":"/"})))},N=function(t){return z(D(t))},Z=function(t){if("string"!==typeof t)return!1;var n=t.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(n)||!/[^\s0-9a-zA-Z\-_]/.test(n)},P=function(t){return{value:t,enumerable:!1,writable:!0,configurable:!0}},Q=function(){var t=function(t,n){return Object.defineProperty(String.prototype,t,P(n))};t("fromBase64",(function(){return N(this)})),t("toBase64",(function(t){return $(this,t)})),t("toBase64URI",(function(){return $(this,!0)})),t("toBase64URL",(function(){return $(this,!0)})),t("toUint8Array",(function(){return w(this)}))},O=function(){var t=function(t,n){return Object.defineProperty(Uint8Array.prototype,t,P(n))};t("toBase64",(function(t){return C(this,t)})),t("toBase64URI",(function(){return C(this,!0)})),t("toBase64URL",(function(){return C(this,!0)}))},L=function(){Q(),O()},q={version:e,VERSION:o,atob:R,atobPolyfill:I,btoa:v,btoaPolyfill:y,fromBase64:N,toBase64:$,encode:$,encodeURI:S,encodeURL:S,utob:U,btou:E,decode:N,isValid:Z,fromUint8Array:C,toUint8Array:w,extendString:Q,extendUint8Array:O,extendBuiltins:L}}}]);
//# sourceMappingURL=2537.09a363ca.js.map