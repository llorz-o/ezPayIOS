{"version":3,"file":"js/8071.de6aa924.js","mappings":"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","sources":["webpack://ez_pay/./src/views/user_login_psw/index.vue?00d8","webpack://ez_pay/src/views/user_login_psw/index.vue","webpack://ez_pay/./src/views/user_login_psw/index.vue?6aa9","webpack://ez_pay/./src/views/user_login_psw/index.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page page-user-login-psw\"},[_c('van-form',{on:{\"submit\":_vm.onSubmit}},[(_vm.$root.isBindPwd)?_c('div',{staticClass:\"form-item\"},[_c('div',{staticClass:\"label\"},[_vm._v(\"旧密码\")]),_c('van-field',{attrs:{\"type\":_vm.showPsw ? 'text' : _vm.$root.dynamicPasswordInputType,\"autocomplete\":\"new-password\",\"placeholder\":\"请输入原密码\"},model:{value:(_vm.form.oldPassword),callback:function ($$v) {_vm.$set(_vm.form, \"oldPassword\", $$v)},expression:\"form.oldPassword\"}},[_c('van-button',{staticClass:\"btn\",attrs:{\"slot\":\"extra\",\"icon\":_vm.showPsw ? 'eye-o' : 'closed-eye',\"native-type\":\"button\",\"size\":\"mini\"},on:{\"click\":function($event){_vm.showPsw = !_vm.showPsw}},slot:\"extra\"})],1),_c('div',{staticClass:\"tip\"},[_vm._v(\"请输入6-15位字母数字组成的密码\")])],1):_vm._e(),_c('div',{staticClass:\"form-item\"},[_c('div',{staticClass:\"label\"},[_vm._v(\"新密码\")]),_c('van-field',{attrs:{\"type\":_vm.showPsw2 ? 'text' : _vm.$root.dynamicPasswordInputType,\"autocomplete\":\"new-password\",\"placeholder\":\"请输入新密码\"},model:{value:(_vm.form.newPassword),callback:function ($$v) {_vm.$set(_vm.form, \"newPassword\", $$v)},expression:\"form.newPassword\"}},[_c('van-button',{staticClass:\"btn\",attrs:{\"slot\":\"extra\",\"icon\":_vm.showPsw2 ? 'eye-o' : 'closed-eye',\"native-type\":\"button\",\"size\":\"mini\"},on:{\"click\":function($event){_vm.showPsw2 = !_vm.showPsw2}},slot:\"extra\"})],1),_c('div',{staticClass:\"tip\"},[_vm._v(\"请输入6-15位字母数字组成的密码\")])],1),_c('div',{staticClass:\"form-item\"},[_c('div',{staticClass:\"label\"},[_vm._v(\"确认新密码\")]),_c('van-field',{attrs:{\"type\":_vm.showPsw3 ? 'text' : _vm.$root.dynamicPasswordInputType,\"autocomplete\":\"new-password\",\"placeholder\":\"请确认新密码\"},model:{value:(_vm.form.confirmPassword),callback:function ($$v) {_vm.$set(_vm.form, \"confirmPassword\", $$v)},expression:\"form.confirmPassword\"}},[_c('van-button',{staticClass:\"btn\",attrs:{\"slot\":\"extra\",\"icon\":_vm.showPsw3 ? 'eye-o' : 'closed-eye',\"native-type\":\"button\",\"size\":\"mini\"},on:{\"click\":function($event){_vm.showPsw3 = !_vm.showPsw3}},slot:\"extra\"})],1),_c('div',{staticClass:\"tip\"},[_vm._v(\"请输入6-15位字母数字组成的密码\")])],1),_c('van-button',{staticClass:\"primary block\",class:{\n        disabled:\n          (_vm.$root.isBindPwd ? !_vm.form.oldPassword : false) ||\n          !_vm.form.newPassword ||\n          !_vm.form.confirmPassword,\n      }},[_vm._v(\" 确定 \")])],1),_c('van-dialog',{staticClass:\"warning\",attrs:{\"close-on-click-overlay\":\"\",\"show-cancel-button\":\"\"},on:{\"confirm\":_vm.onConfirm},scopedSlots:_vm._u([{key:\"title\",fn:function(){return [_c('van-icon',{attrs:{\"name\":\"fail\"}})]},proxy:true}]),model:{value:(_vm.showFailDialog),callback:function ($$v) {_vm.showFailDialog=$$v},expression:\"showFailDialog\"}},[_vm._v(\" 为保障你的账户安全，登录密码修改后 \"),_c('span',[_vm._v(\" 7天 \")]),_vm._v(\" 以内不允许再次修改 \")])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"page page-user-login-psw\">\n    <van-form @submit=\"onSubmit\">\n      <!-- 当前绑定了密码 -->\n      <div v-if=\"$root.isBindPwd\" class=\"form-item\">\n        <div class=\"label\">旧密码</div>\n        <van-field\n          v-model=\"form.oldPassword\"\n          :type=\"showPsw ? 'text' : $root.dynamicPasswordInputType\"\n          autocomplete=\"new-password\"\n          placeholder=\"请输入原密码\"\n        >\n          <van-button\n            slot=\"extra\"\n            :icon=\"showPsw ? 'eye-o' : 'closed-eye'\"\n            class=\"btn\"\n            native-type=\"button\"\n            size=\"mini\"\n            @click=\"showPsw = !showPsw\"\n          >\n          </van-button>\n        </van-field>\n        <div class=\"tip\">请输入6-15位字母数字组成的密码</div>\n      </div>\n\n      <div class=\"form-item\">\n        <div class=\"label\">新密码</div>\n        <van-field\n          v-model=\"form.newPassword\"\n          :type=\"showPsw2 ? 'text' : $root.dynamicPasswordInputType\"\n          autocomplete=\"new-password\"\n          placeholder=\"请输入新密码\"\n        >\n          <van-button\n            slot=\"extra\"\n            :icon=\"showPsw2 ? 'eye-o' : 'closed-eye'\"\n            class=\"btn\"\n            native-type=\"button\"\n            size=\"mini\"\n            @click=\"showPsw2 = !showPsw2\"\n          >\n          </van-button>\n        </van-field>\n        <div class=\"tip\">请输入6-15位字母数字组成的密码</div>\n      </div>\n      <div class=\"form-item\">\n        <div class=\"label\">确认新密码</div>\n        <van-field\n          v-model=\"form.confirmPassword\"\n          :type=\"showPsw3 ? 'text' : $root.dynamicPasswordInputType\"\n          autocomplete=\"new-password\"\n          placeholder=\"请确认新密码\"\n        >\n          <van-button\n            slot=\"extra\"\n            :icon=\"showPsw3 ? 'eye-o' : 'closed-eye'\"\n            class=\"btn\"\n            native-type=\"button\"\n            size=\"mini\"\n            @click=\"showPsw3 = !showPsw3\"\n          >\n          </van-button>\n        </van-field>\n        <div class=\"tip\">请输入6-15位字母数字组成的密码</div>\n      </div>\n\n      <van-button\n        :class=\"{\n          disabled:\n            ($root.isBindPwd ? !form.oldPassword : false) ||\n            !form.newPassword ||\n            !form.confirmPassword,\n        }\"\n        class=\"primary block\"\n      >\n        确定\n      </van-button>\n    </van-form>\n\n    <van-dialog\n      v-model=\"showFailDialog\"\n      class=\"warning\"\n      close-on-click-overlay\n      show-cancel-button\n      @confirm=\"onConfirm\"\n    >\n      <template #title>\n        <van-icon name=\"fail\"/>\n      </template>\n      为保障你的账户安全，登录密码修改后\n      <span> 7天 </span>\n      以内不允许再次修改\n    </van-dialog>\n  </div>\n</template>\n\n<script>\nimport {resetPwd, setPwd} from \"@/apis/user\";\nimport {formatDuration} from \"@/vendor/tools\";\n\nexport default {\n  data() {\n    return {\n      showFailDialog: false,\n      form: {\n        oldPassword: \"\",\n        newPassword: \"\",\n        confirmPassword: \"\",\n      },\n      showPsw: false,\n      showPsw2: false,\n      showPsw3: false,\n    };\n  },\n  created() {\n    this.$root.$emit(\"root:set-topbar\", [\"left-back\"]);\n\n    if (!this.$root.isBindPwd) {\n      this.$root.$emit(\"root:set-title\", \"设置登录密码\");\n      return;\n    }\n\n    const lastSettingPwdTime = this.$root.userInfo.preResetPwdTime;\n    if (lastSettingPwdTime) {\n      const last = this.$tls.dateFix(lastSettingPwdTime * 1000);\n      const now = this.$root.getServerTime();\n      const sevenDays = 7 * 24 * 60 * 60 * 1000;\n      if (now - last < sevenDays) {\n        const duration = formatDuration(sevenDays - now + last);\n        this.$dialog.alert({\n          message: `短期内你已修改过密码，请在${duration}后修改密码！`,\n          confirmButtonColor: \"#6f59fe\",\n          beforeClose: (action, done) => {\n            this.$router.back();\n            done();\n          },\n        });\n      }\n    }\n  },\n  methods: {\n    onSubmit() {\n      // 修改密码\n      if (this.$root.isBindPwd) {\n        if (\n          !/^(?![^a-zA-Z]+$)(?!\\D+$)/.test(this.form.oldPassword) ||\n          this.form.oldPassword.length < 6 ||\n          this.form.oldPassword.length > 15\n        )\n          return this.$toast.fail(\"请输入正确的旧密码\");\n      }\n\n      if (\n        !/^(?![^a-zA-Z]+$)(?!\\D+$)/.test(this.form.newPassword) ||\n        this.form.newPassword.length < 6 ||\n        this.form.newPassword.length > 15\n      )\n        return this.$toast.fail(\"请输入6-15位字母数字组成的密码\");\n      if (this.form.newPassword != this.form.confirmPassword)\n        return this.$toast.fail(\"两次输入的密码不一致\");\n\n      if (this.$root.isBindPwd) {\n        this.showFailDialog = true;\n      } else {\n        // 设置初始密码\n        this.setPwd();\n      }\n    },\n    setPwd() {\n      setPwd({\n        password: this.form.newPassword,\n      }).then(({ok, msg}) => {\n        if (ok) {\n          this.$root.userInfo.isEnteredPassword = true;\n          this.$toast.success(msg);\n        } else {\n          this.$toast.fail(msg);\n        }\n        this.$router.back();\n      });\n    },\n    onConfirm() {\n      resetPwd({\n        oldPassword: this.form.oldPassword,\n        newPassword: this.form.newPassword,\n      }).then(({ok, msg}) => {\n        if (ok) {\n          this.$root.userInfo.preResetPwdTime = this.$root.getServerTime();\n          this.$toast.success(msg);\n          this.$root.exitLogin();\n        } else {\n          this.$toast.fail(msg);\n        }\n        this.$router.back();\n      });\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\">\n.page-user-login-psw {\n  .van-form {\n    padding: 12px;\n  }\n\n  .form-item {\n    .label {\n      font-size: 14;\n      color: #333333ff;\n      margin-top: 12px;\n    }\n\n    .van-field {\n      background-color: #f0f0f0ff;\n      border-radius: 5px;\n      margin: 5px 0;\n\n      .btn {\n        padding: 0 15px;\n        font-size: 25px;\n        background-color: transparent;\n        border: none;\n      }\n    }\n\n    .tip {\n      font-size: 9px;\n      color: #999999ff;\n    }\n  }\n\n  .warning {\n    .van-dialog__header {\n      color: #6f5bfeff;\n      font-size: 15px;\n\n      .van-icon-fail {\n        font-size: 30px;\n        width: 32px;\n        height: 32px;\n        line-height: 32px;\n        background-color: $theme;\n        border-radius: 50%;\n        color: #fff;\n      }\n    }\n\n    .van-dialog__content {\n      text-align: center;\n      font-size: 12px;\n      color: #333333ff;\n      line-height: 1.8;\n      padding: 10px 20px;\n\n      span {\n        color: #fb2222ff;\n      }\n    }\n\n    .van-dialog__confirm {\n      color: $theme;\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=408c3cad&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","on","onSubmit","$root","_v","attrs","showPsw","dynamicPasswordInputType","model","value","form","callback","$$v","$set","expression","$event","slot","_e","showPsw2","showPsw3","class","disabled","isBindPwd","oldPassword","newPassword","confirmPassword","onConfirm","scopedSlots","_u","key","fn","proxy","showFailDialog","staticRenderFns","data","created","message","confirmButtonColor","beforeClose","_this","done","methods","setPwd","password","msg","_this2","resetPwd","_this3","component"],"sourceRoot":""}