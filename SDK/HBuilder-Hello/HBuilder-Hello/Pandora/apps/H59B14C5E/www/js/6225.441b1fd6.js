"use strict";(self["webpackChunkez_pay"]=self["webpackChunkez_pay"]||[]).push([[6225],{36225:function(e,t,a){a.r(t),a.d(t,{default:function(){return A}});var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page page-add_payment"},[a("div",{attrs:{id:"reader-2"}}),a("div",{staticClass:"title title_line"},[e._v("请选择收款方式")]),a("van-radio-group",{model:{value:e.payment,callback:function(t){e.payment=t},expression:"payment"}},[a("van-cell-group",[a("van-cell",{attrs:{clickable:"",title:"银行卡"},on:{click:function(t){e.payment=1}},scopedSlots:e._u([{key:"icon",fn:function(){return[a("div",{staticClass:"payment-icon bank"})]},proxy:!0},{key:"right-icon",fn:function(){return[a("van-radio",{attrs:{name:1}})]},proxy:!0}])}),e.hideAlipayWechat?e._e():a("van-cell",{attrs:{clickable:"",title:"支付宝"},on:{click:function(t){e.payment=2}},scopedSlots:e._u([{key:"icon",fn:function(){return[a("div",{staticClass:"payment-icon ali"})]},proxy:!0},{key:"right-icon",fn:function(){return[a("van-radio",{attrs:{name:2}})]},proxy:!0}],null,!1,364612125)}),e.hideAlipayWechat?e._e():a("van-cell",{attrs:{clickable:"",title:"微信"},on:{click:function(t){e.payment=4}},scopedSlots:e._u([{key:"icon",fn:function(){return[a("div",{staticClass:"payment-icon wechat"})]},proxy:!0},{key:"right-icon",fn:function(){return[a("van-radio",{attrs:{name:4}})]},proxy:!0}],null,!1,1810295219)}),a("van-cell",{attrs:{clickable:"",title:"USDT"},on:{click:function(t){e.payment=8}},scopedSlots:e._u([{key:"icon",fn:function(){return[a("div",{staticClass:"payment-icon usdt"})]},proxy:!0},{key:"right-icon",fn:function(){return[a("van-radio",{attrs:{name:8}})]},proxy:!0}])})],1)],1),1===e.payment?[a("div",{staticClass:"title secondary title_line"},[e._v("填写银行卡信息")]),a("van-form",{on:{submit:e.onSubmit}},[a("van-field",{attrs:{value:e.bankFormData.bankName,autocomplete:"new-password",clickable:"","input-align":"right",label:"银行名称",name:"bank",placeholder:"请选择开户行",readonly:"","right-icon":"arrow"},on:{click:function(t){e.showBankPicker=!0}}}),a("van-field",{attrs:{value:e.bankFormData.bankAddress,autocomplete:"new-password",clickable:"","input-align":"right",label:"开户所在地",name:"bankAddress",placeholder:"请选择",readonly:"","right-icon":"arrow"},on:{click:function(t){e.showBankAddressPicker=!0}}}),a("van-field",{attrs:{autocomplete:"new-password","input-align":"right",label:"开户支行",name:"bankBranch",placeholder:"选填"},model:{value:e.bankFormData.bankBranch,callback:function(t){e.$set(e.bankFormData,"bankBranch",t)},expression:"bankFormData.bankBranch"}}),e.isMerchant?a("van-field",{attrs:{autocomplete:"new-password",label:"姓名",name:"name",readonly:!e.isMerchant},model:{value:e.bankFormData.realName,callback:function(t){e.$set(e.bankFormData,"realName",t)},expression:"bankFormData.realName"}}):a("van-field",{attrs:{value:e.$root.userInfo.realName,autocomplete:"new-password",label:"姓名",name:"name",readonly:""}}),a("van-field",{attrs:{autocomplete:"new-password",label:"卡号",name:"bankNo",placeholder:"储蓄卡",type:"digit"},model:{value:e.bankFormData.bankNo,callback:function(t){e.$set(e.bankFormData,"bankNo",t)},expression:"bankFormData.bankNo"}}),a("van-field",{attrs:{autocomplete:"new-password",label:"资金密码",maxlength:"6",name:"securePassword",placeholder:"6位纯数字资金密码",type:e.$root.dynamicPasswordInputType},model:{value:e.bankFormData.securePassword,callback:function(t){e.$set(e.bankFormData,"securePassword",t)},expression:"bankFormData.securePassword"}}),a("verify-field",{on:{uniqid:function(t){return e.bankFormData.verifyUniqid=t}},model:{value:e.bankFormData.code,callback:function(t){e.$set(e.bankFormData,"code",t)},expression:"bankFormData.code"}}),a("van-button",{staticClass:"block primary",attrs:{"native-type":"submit"}},[e._v(" 确定添加 ")])],1)]:e._e(),2===e.payment?[a("div",{staticClass:"title secondary title_line"},[e._v("填写支付宝信息")]),a("van-form",{on:{submit:e.onSubmit}},[a("van-field",{attrs:{label:"支付宝账号",name:"alipayAccount"},model:{value:e.aliFormData.alipayAccount,callback:function(t){e.$set(e.aliFormData,"alipayAccount",t)},expression:"aliFormData.alipayAccount"}}),e.isMerchant?a("van-field",{attrs:{autocomplete:"new-password",label:"真实姓名",name:"name",readonly:!e.isMerchant},model:{value:e.aliFormData.realName,callback:function(t){e.$set(e.aliFormData,"realName",t)},expression:"aliFormData.realName"}}):a("van-field",{attrs:{value:e.$root.userInfo.realName,autocomplete:"new-password",label:"真实姓名",name:"name",readonly:""}}),a("van-field",{attrs:{value:e.aliFormData.address,autocomplete:"new-password",clickable:"","input-align":"right",label:"所在地区",name:"address",readonly:"","right-icon":"arrow"},on:{click:function(t){e.showBankAddressPicker=!0}}}),a("div",{staticClass:"uploadWrapper"},[a("van-uploader",{attrs:{"after-read":function(t){return e.afterRead(t,"ali")},"max-count":1,"image-fit":"contain","preview-full-image":"","result-type":"file"},nativeOn:{click:function(t){return function(t){return e.onClickUpload("ali",t)}.apply(null,arguments)}},model:{value:e.aliFormData.receiptCode,callback:function(t){e.$set(e.aliFormData,"receiptCode",t)},expression:"aliFormData.receiptCode"}},[a("van-button",{staticClass:"upload"},[a("van-icon",{attrs:{name:"plus"}}),a("div",{staticClass:"text"},[e._v("请上传收款码")])],1)],1)],1),a("van-field",{attrs:{autocomplete:"new-password",label:"资金密码",maxlength:"6",name:"securePassword",placeholder:"6位纯数字资金密码",type:e.$root.dynamicPasswordInputType},model:{value:e.aliFormData.securePassword,callback:function(t){e.$set(e.aliFormData,"securePassword",t)},expression:"aliFormData.securePassword"}}),a("verify-field",{on:{uniqid:function(t){return e.aliFormData.verifyUniqid=t}},model:{value:e.aliFormData.code,callback:function(t){e.$set(e.aliFormData,"code",t)},expression:"aliFormData.code"}}),a("van-button",{staticClass:"block primary",attrs:{disabled:e.submitLoading,loading:e.submitLoading,"native-type":"submit"}},[e._v(" 确定添加 ")])],1),a("div",{staticClass:"example",on:{click:function(t){return e.$router.push("/how_to_save_receive_code")}}},[e._v("如何保存收款码？")])]:e._e(),4===e.payment?[a("div",{staticClass:"title secondary title_line"},[e._v("填写微信信息")]),a("van-form",{on:{submit:e.onSubmit}},[a("van-field",{attrs:{label:"姓名",name:"wxRealname",placeholder:"微信实名姓名"},model:{value:e.wechatFormData.wxRealname,callback:function(t){e.$set(e.wechatFormData,"wxRealname",t)},expression:"wechatFormData.wxRealname"}}),e.isMerchant?a("van-field",{attrs:{autocomplete:"new-password",label:"真实姓名",name:"name",readonly:!e.isMerchant},model:{value:e.wechatFormData.realName,callback:function(t){e.$set(e.wechatFormData,"realName",t)},expression:"wechatFormData.realName"}}):a("van-field",{attrs:{value:e.$root.userInfo.realName,autocomplete:"new-password",label:"真实姓名",name:"name",readonly:""}}),a("van-field",{attrs:{value:e.wechatFormData.address,autocomplete:"new-password",clickable:"","input-align":"right",label:"所在地区",name:"address",readonly:"","right-icon":"arrow"},on:{click:function(t){e.showBankAddressPicker=!0}}}),a("div",{staticClass:"uploadWrapper"},[a("van-uploader",{class:{disableFile:e.$root.isH5Plus},attrs:{"after-read":function(t){return e.afterRead(t,"wechat")},"max-count":1,"image-fit":"contain","preview-full-image":"","result-type":"file"},nativeOn:{click:function(t){return function(t){return e.onClickUpload("wechat",t)}.apply(null,arguments)}},model:{value:e.wechatFormData.receiptCode,callback:function(t){e.$set(e.wechatFormData,"receiptCode",t)},expression:"wechatFormData.receiptCode"}},[a("van-button",{staticClass:"upload"},[a("van-icon",{attrs:{name:"plus"}}),a("div",{staticClass:"text"},[e._v("请上传收款码")])],1)],1)],1),a("van-field",{attrs:{autocomplete:"new-password",label:"资金密码",maxlength:"6",name:"securePassword",placeholder:"6位纯数字资金密码",type:e.$root.dynamicPasswordInputType},model:{value:e.wechatFormData.securePassword,callback:function(t){e.$set(e.wechatFormData,"securePassword",t)},expression:"wechatFormData.securePassword"}}),a("verify-field",{on:{uniqid:function(t){return e.wechatFormData.verifyUniqid=t}},model:{value:e.wechatFormData.code,callback:function(t){e.$set(e.wechatFormData,"code",t)},expression:"wechatFormData.code"}}),a("van-button",{staticClass:"block primary",attrs:{"native-type":"submit"}},[e._v(" 确定添加 ")])],1),a("div",{staticClass:"example",on:{click:function(t){return e.$router.push("/how_to_save_receive_code/1")}}},[e._v(" 如何保存收款码？ ")])]:e._e(),8===e.payment?[a("div",{staticClass:"title secondary title_line"},[e._v("填写USDT收款信息")]),a("van-form",{on:{submit:e.onSubmit}},[a("van-field",{attrs:{value:e.usdtFormData.address,autocomplete:"new-password",clickable:"","input-align":"right",label:"所在地区",name:"address",readonly:"","right-icon":"arrow"},on:{click:function(t){e.showBankAddressPicker=!0}}}),a("van-field",{attrs:{label:"收款地址",name:"usdtAddress",placeholder:"USDT收款地址(TRC20)"},model:{value:e.usdtFormData.usdtAddress,callback:function(t){e.$set(e.usdtFormData,"usdtAddress",t)},expression:"usdtFormData.usdtAddress"}}),a("van-field",{attrs:{autocomplete:"new-password",label:"资金密码",maxlength:"6",name:"securePassword",placeholder:"6位纯数字资金密码",type:e.$root.dynamicPasswordInputType},model:{value:e.usdtFormData.securePassword,callback:function(t){e.$set(e.usdtFormData,"securePassword",t)},expression:"usdtFormData.securePassword"}}),a("verify-field",{on:{uniqid:function(t){return e.usdtFormData.verifyUniqid=t}},model:{value:e.usdtFormData.code,callback:function(t){e.$set(e.usdtFormData,"code",t)},expression:"usdtFormData.code"}}),a("van-button",{staticClass:"block primary",attrs:{"native-type":"submit"}},[e._v(" 确定添加 ")])],1)]:e._e(),a("van-popup",{attrs:{position:"bottom","safe-area-inset-bottom":""},on:{close:function(t){e.bankName=""}},model:{value:e.showBankPicker,callback:function(t){e.showBankPicker=t},expression:"showBankPicker"}},[a("van-field",{attrs:{placeholder:"输入关键字搜索银行"},model:{value:e.bankName,callback:function(t){e.bankName=t},expression:"bankName"}}),a("van-picker",{attrs:{columns:e.filteredBanks,"show-toolbar":"","value-key":"bankName"},on:{cancel:function(t){e.showBankPicker=!1},confirm:e.onConfirmPickBank}})],1),a("van-popup",{attrs:{position:"bottom","safe-area-inset-bottom":""},model:{value:e.showBankAddressPicker,callback:function(t){e.showBankAddressPicker=t},expression:"showBankAddressPicker"}},[a("van-area",{attrs:{"area-list":e.areaList,"columns-num":2,title:"标题"},on:{confirm:e.onConfirmAddress}})],1)],2)},r=[],i=a(37174),o=a(39873),s=(a(83040),a(24603),a(74916),a(88386),a(39714),a(57327),a(41539),a(77601),a(9653),a(68309),a(34553),a(53045)),c=a(42008),u=a(93501),d=a(19934),l=a(26982),h=a(7067),m=a(58913),p=a(35671),f=a(22342),v=(a(24812),a(32564),a(21249),a(54678),a(27852),a(3843),a(83710),a(69600),a(92222),a(26541),a(78783),a(33948),a(26699),a(32023),a(60285),a(41637),function(){function e(t,a,n,r,i){var o=this;(0,p.Z)(this,e),this._legacyCanvasSize=e.DEFAULT_CANVAS_SIZE,this._preferredCamera="environment",this._maxScansPerSecond=25,this._lastScanTimestamp=-1,this._destroyed=this._flashOn=this._paused=this._active=!1,this.$video=t,this.$canvas=document.createElement("canvas"),n&&"object"===(0,m.Z)(n)?this._onDecode=a:(n||r||i?console.warn("You're using a deprecated version of the QrScanner constructor which will be removed in the future"):console.warn("Note that the type of the scan result passed to onDecode will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),this._legacyOnDecode=a),a="object"===(0,m.Z)(n)?n:{},this._onDecodeError=a.onDecodeError||("function"===typeof n?n:this._onDecodeError),this._calculateScanRegion=a.calculateScanRegion||("function"===typeof r?r:this._calculateScanRegion),this._preferredCamera=a.preferredCamera||i||this._preferredCamera,this._legacyCanvasSize="number"===typeof n?n:"number"===typeof r?r:this._legacyCanvasSize,this._maxScansPerSecond=a.maxScansPerSecond||this._maxScansPerSecond,this._onPlay=this._onPlay.bind(this),this._onLoadedMetaData=this._onLoadedMetaData.bind(this),this._onVisibilityChange=this._onVisibilityChange.bind(this),this._updateOverlay=this._updateOverlay.bind(this),t.disablePictureInPicture=!0,t.playsInline=!0,t.muted=!0;var s=!1;if(t.hidden&&(t.hidden=!1,s=!0),document.body.contains(t)||(document.body.appendChild(t),s=!0),n=t.parentElement,a.highlightScanRegion||a.highlightCodeOutline){if(r=!!a.overlay,this.$overlay=a.overlay||document.createElement("div"),i=this.$overlay.style,i.position="absolute",i.display="none",i.pointerEvents="none",this.$overlay.classList.add("scan-region-highlight"),!r&&a.highlightScanRegion){this.$overlay.innerHTML='<svg class="scan-region-highlight-svg" viewBox="0 0 238 238" preserveAspectRatio="none" style="position:absolute;width:100%;height:100%;left:0;top:0;fill:none;stroke:#e9b213;stroke-width:4;stroke-linecap:round;stroke-linejoin:round"><path d="M31 2H10a8 8 0 0 0-8 8v21M207 2h21a8 8 0 0 1 8 8v21m0 176v21a8 8 0 0 1-8 8h-21m-176 0H10a8 8 0 0 1-8-8v-21"/></svg>';try{this.$overlay.firstElementChild.animate({transform:["scale(.98)","scale(1.01)"]},{duration:400,iterations:1/0,direction:"alternate",easing:"ease-in-out"})}catch(c){}n.insertBefore(this.$overlay,this.$video.nextSibling)}a.highlightCodeOutline&&(this.$overlay.insertAdjacentHTML("beforeend",'<svg class="code-outline-highlight" preserveAspectRatio="none" style="display:none;width:100%;height:100%;fill:none;stroke:#e9b213;stroke-width:5;stroke-dasharray:25;stroke-linecap:round;stroke-linejoin:round"><polygon/></svg>'),this.$codeOutlineHighlight=this.$overlay.lastElementChild)}this._scanRegion=this._calculateScanRegion(t),requestAnimationFrame((function(){var e=window.getComputedStyle(t);"none"===e.display&&(t.style.setProperty("display","block","important"),s=!0),"visible"!==e.visibility&&(t.style.setProperty("visibility","visible","important"),s=!0),s&&(console.warn("QrScanner has overwritten the video hiding style to avoid Safari stopping the playback."),t.style.opacity="0",t.style.width="0",t.style.height="0",o.$overlay&&o.$overlay.parentElement&&o.$overlay.parentElement.removeChild(o.$overlay),delete o.$overlay,delete o.$codeOutlineHighlight),o.$overlay&&o._updateOverlay()})),t.addEventListener("play",this._onPlay),t.addEventListener("loadedmetadata",this._onLoadedMetaData),document.addEventListener("visibilitychange",this._onVisibilityChange),window.addEventListener("resize",this._updateOverlay),this._qrEnginePromise=e.createQrEngine()}return(0,f.Z)(e,[{key:"hasFlash",value:function(){var t=(0,o.Z)(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!this.$video.srcObject){t.next=7;break}if(this.$video.srcObject instanceof MediaStream){t.next=4;break}return t.abrupt("return",!1);case 4:a=this.$video.srcObject,t.next=10;break;case 7:return t.next=9,this._getCameraStream();case 9:a=t.sent.stream;case 10:return t.abrupt("return","torch"in a.getVideoTracks()[0].getSettings());case 13:return t.prev=13,t.t0=t["catch"](0),t.abrupt("return",!1);case 16:return t.prev=16,a&&a!==this.$video.srcObject&&(console.warn("Call hasFlash after successfully starting the scanner to avoid creating a temporary video stream"),e._stopVideoStream(a)),t.finish(16);case 19:case"end":return t.stop()}}),t,this,[[0,13,16,19]])})));function a(){return t.apply(this,arguments)}return a}()},{key:"isFlashOn",value:function(){return this._flashOn}},{key:"toggleFlash",value:function(){var e=(0,o.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this._flashOn){e.next=5;break}return e.next=3,this.turnFlashOff();case 3:e.next=7;break;case 5:return e.next=7,this.turnFlashOn();case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"turnFlashOn",value:function(){var e=(0,o.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this._flashOn||this._destroyed||(this._flashOn=!0,!this._active||this._paused)){e.next=13;break}return e.prev=1,e.next=4,this.hasFlash();case 4:if(e.sent){e.next=6;break}throw"No flash available";case 6:return e.next=8,this.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:!0}]});case 8:e.next=13;break;case 10:throw e.prev=10,e.t0=e["catch"](1),this._flashOn=!1,e.t0;case 13:case"end":return e.stop()}}),e,this,[[1,10]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"turnFlashOff",value:function(){var e=(0,o.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.t0=this._flashOn,!e.t0){e.next=5;break}return this._flashOn=!1,e.next=5,this._restartVideoStream();case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"destroy",value:function(){this.$video.removeEventListener("loadedmetadata",this._onLoadedMetaData),this.$video.removeEventListener("play",this._onPlay),document.removeEventListener("visibilitychange",this._onVisibilityChange),window.removeEventListener("resize",this._updateOverlay),this._destroyed=!0,this._flashOn=!1,this.stop(),e._postWorkerMessage(this._qrEnginePromise,"close")}},{key:"start",value:function(){var t=(0,o.Z)(regeneratorRuntime.mark((function t(){var a,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this._destroyed){t.next=2;break}throw Error("The QR scanner can not be started as it had been destroyed.");case 2:if(this._active&&!this._paused){t.next=30;break}if("https:"!==window.location.protocol&&console.warn("The camera stream is only accessible if the page is transferred via https."),this._active=!0,document.hidden){t.next=30;break}if(this._paused=!1,!this.$video.srcObject){t.next=9;break}return t.next=7,this.$video.play();case 7:t.next=30;break;case 9:return t.prev=9,t.next=12,this._getCameraStream();case 12:if(a=t.sent,n=a.stream,r=a.facingMode,this._active&&!this._paused){t.next=19;break}e._stopVideoStream(n),t.next=24;break;case 19:return this._setVideoMirror(r),this.$video.srcObject=n,t.next=23,this.$video.play();case 23:this._flashOn&&(this._flashOn=!1,this.turnFlashOn()["catch"]((function(){})));case 24:t.next=30;break;case 26:if(t.prev=26,t.t0=t["catch"](9),this._paused){t.next=30;break}throw this._active=!1,t.t0;case 30:case"end":return t.stop()}}),t,this,[[9,26]])})));function a(){return t.apply(this,arguments)}return a}()},{key:"stop",value:function(){this.pause(),this._active=!1}},{key:"pause",value:function(){var t=(0,o.Z)(regeneratorRuntime.mark((function t(){var a,n,r=this,i=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=i.length>0&&void 0!==i[0]&&i[0],this._paused=!0,this._active){t.next=4;break}return t.abrupt("return",!0);case 4:if(this.$video.pause(),this.$overlay&&(this.$overlay.style.display="none"),n=function(){r.$video.srcObject instanceof MediaStream&&(e._stopVideoStream(r.$video.srcObject),r.$video.srcObject=null)},!a){t.next=9;break}return t.abrupt("return",(n(),!0));case 9:return t.next=11,new Promise((function(e){return setTimeout(e,300)}));case 11:if(this._paused){t.next=13;break}return t.abrupt("return",!1);case 13:return n(),t.abrupt("return",!0);case 15:case"end":return t.stop()}}),t,this)})));function a(){return t.apply(this,arguments)}return a}()},{key:"setCamera",value:function(){var e=(0,o.Z)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.t0=t!==this._preferredCamera,!e.t0){e.next=5;break}return this._preferredCamera=t,e.next=5,this._restartVideoStream();case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setGrayscaleWeights",value:function(t,a,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];e._postWorkerMessage(this._qrEnginePromise,"grayscaleWeights",{red:t,green:a,blue:n,useIntegerApproximation:r})}},{key:"setInversionMode",value:function(t){e._postWorkerMessage(this._qrEnginePromise,"inversionMode",t)}},{key:"_onPlay",value:function(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay(),this.$overlay&&(this.$overlay.style.display=""),this._scanFrame()}},{key:"_onLoadedMetaData",value:function(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay()}},{key:"_onVisibilityChange",value:function(){document.hidden?this.pause():this._active&&this.start()}},{key:"_calculateScanRegion",value:function(e){var t=Math.round(2/3*Math.min(e.videoWidth,e.videoHeight));return{x:Math.round((e.videoWidth-t)/2),y:Math.round((e.videoHeight-t)/2),width:t,height:t,downScaledWidth:this._legacyCanvasSize,downScaledHeight:this._legacyCanvasSize}}},{key:"_updateOverlay",value:function(){var e=this;requestAnimationFrame((function(){if(e.$overlay){var t=e.$video,a=t.videoWidth,n=t.videoHeight,r=t.offsetWidth,o=t.offsetHeight,s=t.offsetLeft,c=t.offsetTop,u=window.getComputedStyle(t),d=u.objectFit,l=a/n,h=r/o;switch(d){case"none":var m=a,p=n;break;case"fill":m=r,p=o;break;default:("cover"===d?l>h:l<h)?(p=o,m=p*l):(m=r,p=m/l),"scale-down"===d&&(m=Math.min(m,a),p=Math.min(p,n))}var f=u.objectPosition.split(" ").map((function(e,t){var a=parseFloat(e);return e.endsWith("%")?(t?o-p:r-m)*a/100:a})),v=(0,i.Z)(f,2),y=v[0],g=v[1];u=e._scanRegion.width||a,h=e._scanRegion.height||n,d=e._scanRegion.x||0;var k=e._scanRegion.y||0;l=e.$overlay.style,l.width="".concat(u/a*m,"px"),l.height="".concat(h/n*p,"px"),l.top="".concat(c+g+k/n*p,"px"),n=/scaleX\(-1\)/.test(t.style.transform),l.left="".concat(s+(n?r-y-m:y)+(n?a-d-u:d)/a*m,"px"),l.transform=t.style.transform}}))}},{key:"_scanFrame",value:function(){var t=this;!this._active||this.$video.paused||this.$video.ended||("requestVideoFrameCallback"in this.$video?this.$video.requestVideoFrameCallback.bind(this.$video):requestAnimationFrame)((0,o.Z)(regeneratorRuntime.mark((function a(){var n,r,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(1>=t.$video.readyState){a.next=29;break}if(n=Date.now()-t._lastScanTimestamp,r=1e3/t._maxScansPerSecond,a.t0=n<r,!a.t0){a.next=6;break}return a.next=6,new Promise((function(e){return setTimeout(e,r-n)}));case 6:return t._lastScanTimestamp=Date.now(),a.prev=7,a.next=10,e.scanImage(t.$video,{scanRegion:t._scanRegion,qrEngine:t._qrEnginePromise,canvas:t.$canvas});case 10:i=a.sent,a.next=18;break;case 13:if(a.prev=13,a.t1=a["catch"](7),t._active){a.next=17;break}return a.abrupt("return");case 17:t._onDecodeError(a.t1);case 18:if(a.t2=!e._disableBarcodeDetector,a.t2){a.next=25;break}return a.next=22,t._qrEnginePromise;case 22:a.t3=a.sent,a.t4=Worker,a.t2=a.t3 instanceof a.t4;case 25:if(a.t5=a.t2,a.t5){a.next=28;break}t._qrEnginePromise=e.createQrEngine();case 28:i?(t._onDecode?t._onDecode(i):t._legacyOnDecode&&t._legacyOnDecode(i.data),t.$codeOutlineHighlight&&(clearTimeout(t._codeOutlineHighlightRemovalTimeout),t._codeOutlineHighlightRemovalTimeout=void 0,t.$codeOutlineHighlight.setAttribute("viewBox","".concat(t._scanRegion.x||0," ")+"".concat(t._scanRegion.y||0," ")+"".concat(t._scanRegion.width||t.$video.videoWidth," ")+"".concat(t._scanRegion.height||t.$video.videoHeight)),t.$codeOutlineHighlight.firstElementChild.setAttribute("points",i.cornerPoints.map((function(e){var t=e.x,a=e.y;return"".concat(t,",").concat(a)})).join(" ")),t.$codeOutlineHighlight.style.display="")):t.$codeOutlineHighlight&&!t._codeOutlineHighlightRemovalTimeout&&(t._codeOutlineHighlightRemovalTimeout=setTimeout((function(){return t.$codeOutlineHighlight.style.display="none"}),100));case 29:t._scanFrame();case 30:case"end":return a.stop()}}),a,null,[[7,13]])}))))}},{key:"_onDecodeError",value:function(t){t!==e.NO_QR_CODE_FOUND&&console.log(t)}},{key:"_getCameraStream",value:function(){var e=(0,o.Z)(regeneratorRuntime.mark((function e(){var t,a,n,r,i,o,s,c,u=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(navigator.mediaDevices){e.next=2;break}throw"Camera not found.";case 2:t=/^(environment|user)$/.test(this._preferredCamera)?"facingMode":"deviceId",a=[{width:{min:1024}},{width:{min:768}},{}],n=a.map((function(e){return Object.assign({},e,(0,h.Z)({},t,{exact:u._preferredCamera}))})),r=0,i=[].concat((0,l.Z)(n),a);case 4:if(!(r<i.length)){e.next=19;break}return o=i[r],e.prev=6,e.next=9,navigator.mediaDevices.getUserMedia({video:o,audio:!1});case 9:return s=e.sent,c=this._getFacingMode(s)||(o.facingMode?this._preferredCamera:"environment"===this._preferredCamera?"user":"environment"),e.abrupt("return",{stream:s,facingMode:c});case 14:e.prev=14,e.t0=e["catch"](6);case 16:r++,e.next=4;break;case 19:throw"Camera not found.";case 20:case"end":return e.stop()}}),e,this,[[6,14]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"_restartVideoStream",value:function(){var e=(0,o.Z)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this._paused,e.next=3,this.pause(!0);case 3:if(e.t1=e.sent,!e.t1){e.next=6;break}e.t1=!t;case 6:if(e.t0=e.t1,!e.t0){e.next=9;break}e.t0=this._active;case 9:if(e.t2=e.t0,!e.t2){e.next=13;break}return e.next=13,this.start();case 13:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"_setVideoMirror",value:function(e){this.$video.style.transform="scaleX("+("user"===e?-1:1)+")"}},{key:"_getFacingMode",value:function(e){return(e=e.getVideoTracks()[0])?/rear|back|environment/i.test(e.label)?"environment":/front|user|face/i.test(e.label)?"user":null:null}}],[{key:"WORKER_PATH",set:function(e){console.warn("Setting QrScanner.WORKER_PATH is not required and not supported anymore. Have a look at the README for new setup instructions.")}},{key:"hasCamera",value:function(){var t=(0,o.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.listCameras(!1);case 3:return t.abrupt("return",!!t.sent.length);case 6:return t.prev=6,t.t0=t["catch"](0),t.abrupt("return",!1);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));function a(){return t.apply(this,arguments)}return a}()},{key:"listCameras",value:function(){var t=(0,o.Z)(regeneratorRuntime.mark((function t(){var a,n,r,i=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=i.length>0&&void 0!==i[0]&&i[0],navigator.mediaDevices){t.next=3;break}return t.abrupt("return",[]);case 3:if(n=function(){var e=(0,o.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.enumerateDevices();case 2:return e.abrupt("return",e.sent.filter((function(e){return"videoinput"===e.kind})));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.prev=4,t.t0=a,!t.t0){t.next=10;break}return t.next=9,n();case 9:t.t0=t.sent.every((function(e){return!e.label}));case 10:if(t.t1=t.t0,!t.t1){t.next=15;break}return t.next=14,navigator.mediaDevices.getUserMedia({audio:!1,video:!0});case 14:r=t.sent;case 15:t.next=19;break;case 17:t.prev=17,t.t2=t["catch"](4);case 19:return t.prev=19,t.next=22,n();case 22:return t.abrupt("return",t.sent.map((function(e,t){return{id:e.deviceId,label:e.label||(0===t?"Default Camera":"Camera ".concat(t+1))}})));case 23:return t.prev=23,r&&(console.warn("Call listCameras after successfully starting a QR scanner to avoid creating a temporary video stream"),e._stopVideoStream(r)),t.finish(23);case 26:case"end":return t.stop()}}),t,null,[[4,17],[19,,23,26]])})));function a(){return t.apply(this,arguments)}return a}()},{key:"scanImage",value:function(){var t=(0,o.Z)(regeneratorRuntime.mark((function t(a,n,r,s){var c,u,d,l,h,m,p,f,v,y,g,k,b,w=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return c=w.length>4&&void 0!==w[4]&&w[4],u=w.length>5&&void 0!==w[5]&&w[5],l=!1,n&&("scanRegion"in n||"qrEngine"in n||"canvas"in n||"disallowCanvasResizing"in n||"alsoTryWithoutScanRegion"in n||"returnDetailedScanResult"in n)?(d=n.scanRegion,r=n.qrEngine,s=n.canvas,c=n.disallowCanvasResizing||!1,u=n.alsoTryWithoutScanRegion||!1,l=!0):n||r||s||c||u?console.warn("You're using a deprecated api for scanImage which will be removed in the future."):console.warn("Note that the return type of scanImage will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),n=!!r,t.prev=5,t.next=8,Promise.all([r||e.createQrEngine(),e._loadImage(a)]);case 8:if(p=t.sent,f=(0,i.Z)(p,2),r=f[0],h=f[1],v=e._drawToCanvas(h,d,s,c),y=(0,i.Z)(v,2),s=y[0],m=y[1],!(r instanceof Worker)){t.next=24;break}return k=r,n||e._postWorkerMessageSync(k,"inversionMode","both"),t.next=21,new Promise((function(t,a){var n,r,i,o=-1;r=function(s){s.data.id===o&&(k.removeEventListener("message",r),k.removeEventListener("error",i),clearTimeout(n),null!==s.data.data?t({data:s.data.data,cornerPoints:e._convertPoints(s.data.cornerPoints,d)}):a(e.NO_QR_CODE_FOUND))},i=function(e){k.removeEventListener("message",r),k.removeEventListener("error",i),clearTimeout(n),a("Scanner error: "+(e?e.message||e:"Unknown Error"))},k.addEventListener("message",r),k.addEventListener("error",i),n=setTimeout((function(){return i("timeout")}),1e4);var c=m.getImageData(0,0,s.width,s.height);o=e._postWorkerMessageSync(k,"decode",c,[c.data.buffer])}));case 21:g=t.sent,t.next=27;break;case 24:return t.next=26,Promise.race([new Promise((function(e,t){return window.setTimeout((function(){return t("Scanner error: timeout")}),1e4)})),(0,o.Z)(regeneratorRuntime.mark((function t(){var n,o,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.detect(s);case 3:if(n=t.sent,o=(0,i.Z)(n,1),l=o[0],l){t.next=8;break}throw e.NO_QR_CODE_FOUND;case 8:return t.abrupt("return",{data:l.rawValue,cornerPoints:e._convertPoints(l.cornerPoints,d)});case 11:if(t.prev=11,t.t0=t["catch"](0),l=t.t0.message||t.t0,!/not implemented|service unavailable/.test(l)){t.next=16;break}return t.abrupt("return",(e._disableBarcodeDetector=!0,e.scanImage(a,{scanRegion:d,canvas:s,disallowCanvasResizing:c,alsoTryWithoutScanRegion:u})));case 16:throw"Scanner error: ".concat(l);case 17:case"end":return t.stop()}}),t,null,[[0,11]])})))()]);case 26:g=t.sent;case 27:return t.abrupt("return",l?g:g.data);case 30:if(t.prev=30,t.t0=t["catch"](5),d&&u){t.next=34;break}throw t.t0;case 34:return t.next=36,e.scanImage(a,{qrEngine:r,canvas:s,disallowCanvasResizing:c});case 36:return b=t.sent,t.abrupt("return",l?b:b.data);case 38:return t.prev=38,n||e._postWorkerMessage(r,"close"),t.finish(38);case 41:case"end":return t.stop()}}),t,null,[[5,30,38,41]])})));function a(e,a,n,r){return t.apply(this,arguments)}return a}()},{key:"createQrEngine",value:function(){var t=(0,o.Z)(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n&&console.warn("Specifying a worker path is not required and not supported anymore."),t.t0=!e._disableBarcodeDetector&&"BarcodeDetector"in window&&BarcodeDetector.getSupportedFormats,!t.t0){t.next=6;break}return t.next=5,BarcodeDetector.getSupportedFormats();case 5:t.t0=t.sent.includes("qr_code");case 6:if(!t.t0){t.next=10;break}t.t1=new BarcodeDetector({formats:["qr_code"]}),t.next=11;break;case 10:t.t1=a.e(8234).then(a.bind(a,88234)).then((function(e){return e.createWorker()}));case 11:return t.abrupt("return",t.t1);case 12:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}()},{key:"_convertPoints",value:function(e,t){if(!t)return e;var a=t.x||0,n=t.y||0,r=t.width&&t.downScaledWidth?t.width/t.downScaledWidth:1;t=t.height&&t.downScaledHeight?t.height/t.downScaledHeight:1;var i,o=(0,d.Z)(e);try{for(o.s();!(i=o.n()).done;){var s=i.value;s.x=s.x*r+a,s.y=s.y*t+n}}catch(c){o.e(c)}finally{o.f()}return e}},{key:"_stopVideoStream",value:function(e){var t,a=(0,d.Z)(e.getTracks());try{for(a.s();!(t=a.n()).done;){var n=t.value;n.stop(),e.removeTrack(n)}}catch(r){a.e(r)}finally{a.f()}}},{key:"_drawToCanvas",value:function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];a=a||document.createElement("canvas");var r=t&&t.x?t.x:0,i=t&&t.y?t.y:0,o=t&&t.width?t.width:e.videoWidth||e.width,s=t&&t.height?t.height:e.videoHeight||e.height;return n||(n=t&&t.downScaledWidth?t.downScaledWidth:o,t=t&&t.downScaledHeight?t.downScaledHeight:s,a.width!==n&&(a.width=n),a.height!==t&&(a.height=t)),t=a.getContext("2d",{alpha:!1}),t.imageSmoothingEnabled=!1,t.drawImage(e,r,i,o,s,0,0,a.width,a.height),[a,t]}},{key:"_loadImage",value:function(){var t=(0,o.Z)(regeneratorRuntime.mark((function t(a){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(a instanceof Image)){t.next=4;break}return t.next=3,e._awaitImageLoad(a);case 3:return t.abrupt("return",a);case 4:if(!(a instanceof HTMLVideoElement||a instanceof HTMLCanvasElement||a instanceof SVGImageElement||"OffscreenCanvas"in window&&a instanceof OffscreenCanvas||"ImageBitmap"in window&&a instanceof ImageBitmap)){t.next=6;break}return t.abrupt("return",a);case 6:if(!(a instanceof File||a instanceof Blob||a instanceof URL||"string"===typeof a)){t.next=18;break}return n=new Image,n.src=a instanceof File||a instanceof Blob?URL.createObjectURL(a):a.toString(),t.prev=9,t.next=12,e._awaitImageLoad(n);case 12:return t.abrupt("return",n);case 13:return t.prev=13,(a instanceof File||a instanceof Blob)&&URL.revokeObjectURL(n.src),t.finish(13);case 16:t.next=19;break;case 18:throw"Unsupported image type.";case 19:case"end":return t.stop()}}),t,null,[[9,,13,16]])})));function a(e){return t.apply(this,arguments)}return a}()},{key:"_awaitImageLoad",value:function(){var e=(0,o.Z)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.t0=t.complete&&0!==t.naturalWidth,e.t0){e.next=4;break}return e.next=4,new Promise((function(e,a){var n=function n(r){t.removeEventListener("load",n),t.removeEventListener("error",n),r instanceof ErrorEvent?a("Image load error"):e()};t.addEventListener("load",n),t.addEventListener("error",n)}));case 4:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"_postWorkerMessage",value:function(){var t=(0,o.Z)(regeneratorRuntime.mark((function t(a,n,r,i){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,a;case 3:return t.t1=t.sent,t.t2=n,t.t3=r,t.t4=i,t.abrupt("return",t.t0._postWorkerMessageSync.call(t.t0,t.t1,t.t2,t.t3,t.t4));case 8:case"end":return t.stop()}}),t)})));function a(e,a,n,r){return t.apply(this,arguments)}return a}()},{key:"_postWorkerMessageSync",value:function(t,a,n,r){if(!(t instanceof Worker))return-1;var i=e._workerMessageId++;return t.postMessage({id:i,type:a,data:n},r),i}}]),e}());v.DEFAULT_CANVAS_SIZE=400,v.NO_QR_CODE_FOUND="No QR code found",v._disableBarcodeDetector=!1,v._workerMessageId=0;var y=v,g=a(41206),k=a(39766),b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("van-field",e._g(e._b({staticClass:"verify",attrs:{label:"验证码",placeholder:"图形验证码"}},"van-field",e.$attrs,!1),e.$listeners),[a("van-image",{staticClass:"image",attrs:{slot:"button",src:e.image},on:{click:e.flush},slot:"button"})],1)},w=[],_=a(64436),D={data:function(){return{image:""}},watch:{"$attrs.value":function(e,t){4===t.length&&0===e.length&&this.flush()}},created:function(){this.flush()},methods:{flush:function(){var e=this;(0,_.mg)({codeType:"addCard"}).then((function(t){var a=t.ok,n=t.data,r=t.code;if(a)e.image=n.verifyCode,e.$emit("uniqid",n.verifyUniqid);else if(400===r)return e.$toast.fail("请输入合法的手机号码")}))}}},x=D,F=a(1001),$=(0,F.Z)(x,b,w,!1,null,"1cb84be0",null),C=$.exports,R=a(89828),P={mixins:[R.mi],components:{VerifyField:C},data:function(){return{payment:1,showBankPicker:!1,showBankAddressPicker:!1,areaList:{},submitLoading:!1,bankName:"",bankFormData:{bankId:"",bankName:"",bankAddress:"",provinceId:"",cityId:"",bankBranch:"",bankNo:"",securePassword:"",verifyUniqid:"",code:"",realName:""},wechatFormData:{wxRealname:"",realName:"",securePassword:"",address:"",provinceId:"",cityId:"",receiptCode:[],qrContent:"",verifyUniqid:"",code:""},aliFormData:{alipayAccount:"",realName:"",securePassword:"",address:"",provinceId:"",cityId:"",receiptCode:[],qrContent:"",verifyUniqid:"",code:""},usdtFormData:{address:"",provinceId:"",cityId:"",usdtAddress:"",securePassword:"",verifyUniqid:"",code:""}}},watch:{payment:function(e){1!=e&&(this.bankFormData={bankId:"",bankName:"",bankAddress:"",provinceId:"",cityId:"",bankBranch:"",bankNo:"",securePassword:"",verifyUniqid:"",code:""}),2!=e&&(this.aliFormData={alipayAccount:"",securePassword:"",address:"",provinceId:"",cityId:"",receiptCode:[],verifyUniqid:"",code:""}),4!=e&&(this.wechatFormData={wxRealname:"",securePassword:"",address:"",provinceId:"",cityId:"",receiptCode:[],verifyUniqid:"",code:""}),8!=e&&(this.usdtFormData={address:"",provinceId:"",cityId:"",usdtAddress:"",securePassword:"",verifyUniqid:"",code:""})}},computed:{filteredBanks:function(){if(this.bankName){var e=new RegExp("(".concat(this.bankName,")+"),"g");return this.$root.banks.filter((function(t){if(e.test(t.bankName))return t}))}return this.$root.banks}},created:function(){var e=this;return(0,o.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,g.e5)();case 2:if(t.t0=t.sent.areaList,t.t0){t.next=5;break}t.t0={};case 5:e.areaList=t.t0,e.$root.loadPayments(),e.$root.$emit("root:set-topbar",["left-back"]),e.payment=Number(e.$route.params.index||1);case 9:case"end":return t.stop()}}),t)})))()},methods:{onConfirmPickBank:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.bankId,a=e.bankName;this.showBankPicker=!1,t&&(this.bankFormData.bankId=t,this.bankFormData.bankName=a)},onConfirmAddress:function(e){var t=(0,i.Z)(e,2),a=t[0],n=t[1];1==this.payment&&(this.bankFormData.provinceId=a.code,this.bankFormData.cityId=n.code,this.bankFormData.bankAddress=a.name+"  "+n.name),2==this.payment&&(this.aliFormData.provinceId=a.code,this.aliFormData.cityId=n.code,this.aliFormData.address=a.name+"  "+n.name),4==this.payment&&(this.wechatFormData.provinceId=a.code,this.wechatFormData.cityId=n.code,this.wechatFormData.address=a.name+"  "+n.name),8==this.payment&&(this.usdtFormData.provinceId=a.code,this.usdtFormData.cityId=n.code,this.usdtFormData.address=a.name+"  "+n.name),this.showBankAddressPicker=!1},afterRead:function(e,t){var a=this,n="wechat"===t?"wechatFormData":"ali"===t?"aliFormData":"",r=function(){e.status="uploading",e.message="上传中...",(0,c.ws)({_file:e.file,imgFile:a.$root.isH5Plus?e._filePath:e.file,type:"other"}).then((function(t){var r=t.ok,i=t.data,o=t.msg;if(r){e.status="done";var s=i.name,c=a.$root.getImageUrl(i.name);console.log("上传支付收款码成功：",c),a[n].receiptCode=[{url:c,imageUrl:s}]}else e.status="error",e.message="上传失败",a.$toast.fail(o)}))},i=new u.t2("reader-2");i.scanFile(e.file,!0).then((function(e){a[n].qrContent=e,r()}))["catch"]((function(t){y.scanImage(e.file).then((function(e){a[n].qrContent=e,r()}))["catch"]((function(e){var r=e||t;a[n].qrContent="",a.$toast.fail("无法识别收款码:".concat(r))}))}))},onSubmit:function(){var e=this;return(0,o.Z)(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,k.D)(e);case 2:a=t.sent,a&&e.submit();case 4:case"end":return t.stop()}}),t)})))()},submit:function(){var e=this,t={type:this.payment};if(1===this.payment){if(!this.bankFormData.bankId)return this.$toast.fail("请选择银行");if(!this.bankFormData.bankAddress)return this.$toast.fail("请选择开户所在地");if(this.isMerchant&&!this.bankFormData.realName)return this.$toast.fail("请输入真实用姓名");if(!this.bankFormData.bankNo)return this.$toast.fail("请输入银行卡号");if(this.bankFormData.bankNo.length<10||this.bankFormData.bankNo.length>20)return this.$toast.fail("银行卡号为10-20位数字");if(!/^\d{6}$/.test(this.bankFormData.securePassword))return this.$toast.fail("请输入6数字组成的资金密码");if(this.$root.payments.bank.list.findIndex((function(t){return t.bankNo===e.bankFormData.bankNo}))>-1)return this.$toast.fail("该银行卡号已绑定");Object.assign(t,{bankNo:this.bankFormData.bankNo,bankId:this.bankFormData.bankId,bankBranch:this.bankFormData.bankBranch,provinceId:this.bankFormData.provinceId,cityId:this.bankFormData.cityId,securePassword:this.bankFormData.securePassword,verifyUniqid:this.bankFormData.verifyUniqid,code:this.bankFormData.code,realName:this.bankFormData.realName})}if(2===this.payment){if(!this.aliFormData.alipayAccount)return this.$toast.fail("请输入支付宝账号");if(this.isMerchant&&!this.aliFormData.realName)return this.$toast.fail("请输入真实姓名");if(!this.aliFormData.address)return this.$toast.fail("请输入所在地区");if(""===this.aliFormData.qrContent)return this.$toast.fail("请上传收款码");if(!/^\d{6}$/.test(this.aliFormData.securePassword))return this.$toast.fail("请输入6数字组成的资金密码");Object.assign(t,{alipayAccount:this.aliFormData.alipayAccount,qrContent:this.aliFormData.qrContent,provinceId:this.aliFormData.provinceId,cityId:this.aliFormData.cityId,receiptCode:this.aliFormData.receiptCode[0].imageUrl,securePassword:this.aliFormData.securePassword,verifyUniqid:this.aliFormData.verifyUniqid,code:this.aliFormData.code,realName:this.aliFormData.realName})}if(4===this.payment){if(!this.wechatFormData.wxRealname)return this.$toast.fail("请输入微信姓名");if(this.isMerchant&&!this.wechatFormData.realName)return this.$toast.fail("请输入真实姓名");if(!this.wechatFormData.address)return this.$toast.fail("请输入所在地区");if(""===this.wechatFormData.qrContent)return this.$toast.fail("请上传收款码");if(!/^\d{6}$/.test(this.wechatFormData.securePassword))return this.$toast.fail("请输入6数字组成的资金密码");Object.assign(t,{wxRealname:this.wechatFormData.wxRealname,qrContent:this.wechatFormData.qrContent,provinceId:this.wechatFormData.provinceId,cityId:this.wechatFormData.cityId,receiptCode:this.wechatFormData.receiptCode[0].imageUrl,securePassword:this.wechatFormData.securePassword,verifyUniqid:this.wechatFormData.verifyUniqid,code:this.wechatFormData.code,realName:this.wechatFormData.realName})}if(8===this.payment){if(!this.usdtFormData.usdtAddress)return this.$toast.fail("请输入USDT收款地址");if(!/^\d{6}$/.test(this.usdtFormData.securePassword))return this.$toast.fail("请输入6数字组成的资金密码");if(!this.usdtFormData.provinceId||!this.usdtFormData.cityId)return this.$toast.fail("请选择所在地区");Object.assign(t,{provinceId:this.usdtFormData.provinceId,cityId:this.usdtFormData.cityId,usdtAddress:this.usdtFormData.usdtAddress,securePassword:this.usdtFormData.securePassword,verifyUniqid:this.usdtFormData.verifyUniqid,code:this.usdtFormData.code})}this.submitLoading=!0,this.isMerchant&&(t.isBusiness=!0),(0,s._w)(t).then((function(t){var a=t.ok,n=(t.data,t.msg),r=t.code;e.submitLoading=!1,a?(2==e.payment?e.$dialog.alert({title:"提交成功",message:"绑定支付宝账号需后台审核通过后才可以正常使用。审核部门会尽快处理，请耐心等待，感谢你的支持！",confirmButtonText:"我知道了"}):e.$toast.success(n),e.resetForm(),e.$root.loadPayments()):(1002!==r&&(e.aliFormData.qrContent="",e.aliFormData.receiptCode=[],e.wechatFormData.qrContent="",e.wechatFormData.receiptCode=[]),e.bankFormData.code="",e.aliFormData.code="",e.wechatFormData.code="",e.usdtFormData.code="",e.$toast.fail(n))}))},resetForm:function(){this.bankFormData={bankId:"",bankName:"",bankAddress:"",provinceId:"",cityId:"",bankBranch:"",bankNo:"",securePassword:"",realName:""},this.aliFormData={alipayAccount:"",securePassword:"",address:"",provinceId:"",cityId:"",receiptCode:[],qrContent:""},this.wechatFormData={securePassword:"",address:"",provinceId:"",cityId:"",receiptCode:[],qrContent:""},this.usdtFormData={address:"",provinceId:"",cityId:"",usdtAddress:"",securePassword:""}},onClickUpload:function(e,t){var a=this,n=this;this.$root.isH5Plus&&(t.preventDefault(),window.h5p.uploadImage(function(){var t=(0,o.Z)(regeneratorRuntime.mark((function t(r,i,o,s){var c,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r?(c="wechat"===e?"wechatFormData":"ali"===e?"aliFormData":"",c&&(u=new File([r],i,{type:o}),n[c].receiptCode=[{file:u,_filePath:s}],n.afterRead(n[c].receiptCode[0],e))):a.$toast.fail("获取图片失败");case 1:case"end":return t.stop()}}),t)})));return function(e,a,n,r){return t.apply(this,arguments)}}()))}}},I=P,S=(0,F.Z)(I,n,r,!1,null,null,null),A=S.exports},64436:function(e,t,a){a.d(t,{H6:function(){return o},Z3:function(){return i},mg:function(){return r}});var n=a(95426),r=function(e){return(0,n.q)({url:"/Api/Common/VerifyCode/getImageCode",method:"POST",data:e})},i=function(e){return(0,n.q)({url:"/Api/Common/VerifyCode/sendCode",method:"POST",data:e})},o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.q)({url:"/Api/User/UploadFile/uploadLargeVideo",method:"POST",data:e,opts:t})}},39766:function(e,t,a){a.d(t,{D:function(){return o},x:function(){return i}});var n=a(39873),r=(a(83040),a(41539),a(32564),a(53045)),i=function(e){return e.$toast("请输入资金密码"),new Promise((function(t,a){e.$root.showPassowordKeyboard=!0,e.$root.$once("root:global-password",function(){var e=(0,n.Z)(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t(a));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))},o=function(e){return e.$root.userInfo&&e.$root.userInfo.isGoogleAuthenticator?(e.$toast("请输入Google安全码"),new Promise((function(t,a){setTimeout((function(){e.$root.showPassowordKeyboard=!0,e.$root.$once("root:global-password",function(){var a=(0,n.Z)(regeneratorRuntime.mark((function a(n){var i,o,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n&&"close-by-route-change"!==n){a.next=2;break}return a.abrupt("return",t(!1));case 2:return a.next=4,(0,r.Wg)({safeCode:n});case 4:i=a.sent,o=i.ok,s=i.msg,o?t(!0):(t(!1),e.$toast.fail(s));case 8:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())}),0)}))):Promise.resolve(!0)}},89828:function(e,t,a){a.d(t,{RY:function(){return d},VM:function(){return l},fN:function(){return u},mi:function(){return h}});var n=a(49749),r=a(52336),i=a(39873),o=(a(56977),a(54678),a(32564),a(83040),a(12879)),s=a(75461),c=["ok","data","msg"],u={data:function(){return{cryptoAccountInfo:{address:"",otcTicker:""}}},methods:{businessGetAccountInfo:function(e){var t=this;return(0,i.Z)(regeneratorRuntime.mark((function a(){var i,s,u,d,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,(0,o.bb)({type:e});case 2:return i=a.sent,s=i.ok,u=i.data,d=i.msg,l=(0,r.Z)(i,c),s?(t.cryptoAccountInfo=u,t.updateQRcode()):t.$toast(d),a.abrupt("return",(0,n.Z)({ok:s,data:u,msg:d},l));case 9:case"end":return a.stop()}}),a)})))()},updateQRcode:function(e){s.toDataURL(e||this.cryptoAccountInfo.address).then((function(e){var t=document.querySelector(".QRcode");t&&t.setAttribute("src",e)}))}}},d={computed:{isCryptoMerchant:function(){return"1"===this.$route.query.m},amICryptoMerchant:function(){return 1===this.$root.userInfo.BusinessStatus},ApiPath:function(){return this.isCryptoMerchant?"Business":""},BuyerApiPath:function(){return this.isCryptoMerchant&&this.amICryptoMerchant?"Business":""}}},l={data:function(){return{countdown:0,orderType:"TronDeposit",form:{paymentType:"",amount:""},orderInfo:{userId:null,paymentType:"",amount:"",passageType:"",receivingAddress:"",copeAmount:0,createDate:"",status:"",createTime:"",updateTime:"",orderId:0,orderNo:""}}},computed:{isTrading:function(){return!!this.orderInfo.orderId}},created:function(){this.getDepositDetail(this.isBuyVb)},methods:{getDepositDetail:function(){var e=arguments,t=this;return(0,i.Z)(regeneratorRuntime.mark((function a(){var n,r,i,s,c,u;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.length>0&&void 0!==e[0]&&e[0],a.next=3,(0,o.IA)({orderType:t.orderType});case 3:r=a.sent,i=r.ok,s=r.data,c=r.msg,i?s&&(t.$set(t,"orderInfo",s.order),t.form.amount=n?s.order.amount:s.order.copeAmount,t.form.paymentType=s.order.paymentType,t.cryptoAccountInfo.address=s.order.receivingAddress,t.cryptoAccountInfo.otcTicker=parseFloat(String(s.order.amount/s.order.copeAmount)).toFixed(2),t.updateQRcode(),s.currentStateExpireTime&&(s.currentStateExpireTime.expire?(t.countdown=1e3*s.currentStateExpireTime.expire-t.$root.getServerTime(),t.countdown>0&&(u=setTimeout((function(){return t.getDepositDetail(n)}),5e3),t.$once("hook:beforeDestroy",(function(){return clearTimeout(u)})))):t.countdown=0)):t.$toast(c);case 8:case"end":return a.stop()}}),a)})))()}}},h={computed:{isMerchant:function(){return"1"===this.$route.query.m||"merchant"===this.$route.params.type},hideAlipayWechat:function(){return this.isMerchant&&!this.$root.isMerchantAlipayWechatOpen},hideAlipayWechatAtMerchantPage:function(){return!this.$root.isMerchantAlipayWechatOpen},payments:function(){return this.isMerchant?this.$root.merchantPayments:this.$root.payments}}}}}]);
//# sourceMappingURL=6225.441b1fd6.js.map