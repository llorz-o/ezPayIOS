"use strict";(self["webpackChunkez_pay"]=self["webpackChunkez_pay"]||[]).push([[7152],{45035:function(t,s,e){e.r(s),e.d(s,{default:function(){return S}});var a=function(){var t,s=this,e=s.$createElement,a=s._self._c||e;return a("div",{staticClass:"page page-transaction_sale"},[a("div",{staticClass:"top-wrapper"},[a("div",{staticClass:"card"},[a("div",{staticClass:"title"},[a("span",{staticClass:"split",class:{show:s.status==s.TRANSACTING_ORDER_STATUS.HANGING&&void 0!==s.orderInfo.isSplit}},[s.status==s.TRANSACTING_ORDER_STATUS.HANGING&&void 0!==s.orderInfo.isSplit?[s._v(" "+s._s(s.orderInfo.isSplit?"可拆分":"不可拆分")+" ")]:s._e()],2),a("span",{staticClass:"status",class:s._f("transactingOrderStatus")(s.status)},[s._v(" "+s._s(s._f("transactingOrderStatus")(s.status,"seller-content"))+" ")]),a("span",{staticClass:"btn",class:{loading:s.loading},on:{click:function(){return s.loadDetails(s.orderInfo.orderId)}}},[a("van-icon",{attrs:{name:"replay"}})],1)]),a("div",{staticClass:"time"},[s.status==s.TRANSACTING_ORDER_STATUS.HANGING?[s._v(" 创建时间 "+s._s(s._f("dateFormat")(s.orderInfo.createTime,"Y/M/D h:m:s"))+" ")]:s._e(),s.status==s.TRANSACTING_ORDER_STATUS.BUYER_REQUEST?[a("span",{staticStyle:{color:"red"}},[s._v(" "+s._s(s.$root.waitingSellerConfirmOrderStr)+" ")]),s._v(" 内未操作系统将默认卖家取消交易 ")]:s._e(),s.status==s.TRANSACTING_ORDER_STATUS.WAITING_FOR_TRANSFER?[s._v(" 买家 "),a("span",{staticStyle:{color:"red"}},[s._v(" "+s._s(s.$root.buyerPayingTimeOverStr)+" ")]),s._v(" 内未操作,系统将默认买家取消交易 ")]:s._e(),s.status==s.TRANSACTING_ORDER_STATUS.TRANSFERRED?[a("span",{staticStyle:{color:"red"}},[s._v(" "+s._s(s.$root.waitingSellerCompleteOrderStr)+" ")]),s._v(" 内未操作，默认交易成功，将转币给买家 ")]:s._e(),s.status==s.TRANSACTING_ORDER_STATUS.DISPUTING?[s._v(" 争议订单将由官方客服介入协助处理 ")]:[s._v("  ")]],2),a("div",{staticClass:"orderId"},[s._v(" 挂单编号 "+s._s(s.orderInfo.pendingOrderNo)+" "),a("button",{directives:[{name:"clipboard",rawName:"v-clipboard",value:s.orderInfo.pendingOrderNo||"",expression:"orderInfo.pendingOrderNo || ''"}],staticClass:"copy copyBtn",on:{success:s.$root.copySuccessful}})])])]),a("van-cell",{staticClass:"kv amount",attrs:{title:"购买数量"}},[s._v(" V币 "+s._s(parseFloat(s.orderInfo.amount).toFixed(2))+" ")]),a("van-cell",{staticClass:"kv payment",attrs:{title:"收款方式"}},[s.PAYMENT_METHOD.BANK===s.orderInfo.paymentType?a("div",{staticClass:"payment-icon bank"}):s._e(),s.PAYMENT_METHOD.ALI===s.orderInfo.paymentType?a("div",{staticClass:"payment-icon ali"}):s._e(),s.PAYMENT_METHOD.WE_CHAT===s.orderInfo.paymentType?a("div",{staticClass:"payment-icon wechat"}):s._e()]),s.STEP[s.status]>0?a("van-cell-group",{attrs:{border:!1,title:"交易进度"},scopedSlots:s._u([{key:"title",fn:function(){return[a("span",{staticClass:"title"},[s._v("交易进度")]),s.status==s.TRANSACTING_ORDER_STATUS.BUYER_REQUEST||s.status==s.TRANSACTING_ORDER_STATUS.WAITING_FOR_TRANSFER||s.status==s.TRANSACTING_ORDER_STATUS.TRANSFERRED?a("span",{staticClass:"countdown"},[s._v(" 订单倒计时 "),a("van-count-down",{attrs:{time:s.countdown},on:{finish:s.onCountdownFinish}})],1):s._e()]},proxy:!0}],null,!1,3155898464)},[a("van-steps",{attrs:{active:s.stepsActive}},[a("van-step",[s._v(" "+s._s(s._f("dateFormat")(s.orderInfo.createTime,"M-D"))+" "),s.STEP[s.status]>=1?a("div",{staticClass:"bottom-status time"},[s._v(" "+s._s(s._f("dateFormat")(s.orderInfo.createTime,"h:m:s"))+" ")]):s._e()]),a("van-step",[s._v(" 卖家确认交易 "),s.STEP[s.status]>=1?a("div",{staticClass:"bottom-status",class:s._f("transactingOrderStatus")(s.status,void 0,1)},[s._v(" "+s._s(s._f("transactingOrderStatus")(s.status,"step",1))+" ")]):s._e()]),a("van-step",[s._v(" 买家转账 "),s.STEP[s.status]>=2?a("div",{staticClass:"bottom-status",class:(t={},t["time-over"]=s.isTimeoutDisputing,t[s.transactingOrderStatus(s.status,void 0,2)]=!0,t)},[s.isTimeoutDisputing?[s._v(" 超时取消")]:[s._v(" "+s._s(s._f("transactingOrderStatus")(s.status,"step",2))+" ")]],2):s._e()]),a("van-step",[s._v(" 交易完成 "),s.STEP[s.status]>=3?a("div",{staticClass:"bottom-status",class:s._f("transactingOrderStatus")(s.status)},[s._v(" "+s._s(s._f("transactingOrderStatus")(s.status,"step"))+" ")]):s._e()])],1)],1):s._e(),s.isSystemBuyer&&s.STEP[s.status]>=2?[a("div",{staticClass:"merchant"},[a("div",{staticClass:"title"},[s._v("买方付款信息")]),a("div",{staticClass:"description"},[s._v(" 该用户为平台认证用户，付款信息暂不展示，请卖家查询到款后 放心确认转币 ")]),a("div",{staticClass:"certificated"}),a("div",{staticClass:"certification"}),a(s.componentsMapping[s.radio],{tag:"components",staticClass:"paymentInfo",attrs:{hide:s.hide,payment:s.hide?void 0:s.sellerPayment,title:"卖方收款信息"}}),a("div",{staticClass:"riskDescription gray-8"},[a("div",{staticClass:"title"},[s._v(s._s(s.$root.title)+"风控")]),a("div",[s._v(" 1、为了降低您的交易风险，认证用户已向平台缴纳保证金，请放心 交易。 ")]),a("div",[s._v(" 2、平台认证用户，由平台担保交易资金安全性，如出现资金问题由 平台方全额赔付。 ")])])],1)]:[a(s.componentsMapping[s.radio],{tag:"components",attrs:{hide:s.hide,payment:s.hide?void 0:s.buyerPayment,title:"买方付款信息"}}),s.status==s.TRANSACTING_ORDER_STATUS.BUYER_REQUEST?[a("div",{staticClass:"gray-8"}),a("div",{staticClass:"seller-credit-indicator"},[a("div",{staticClass:"title"},[s._v("买方信用资讯")]),a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("div",{staticClass:"label"},[s._v(s._s(s.buyerOrderIndicator.range)+"日成单数")]),a("div",{staticClass:"value"},[a("span",{staticClass:"bold"},[s._v(" "+s._s(s.buyerOrderIndicator.totalSuccessfulOrder)+" ")])])]),a("div",{staticClass:"col"},[a("div",{staticClass:"label"},[s._v(s._s(s.buyerOrderIndicator.range)+"日成单率")]),a("div",{staticClass:"value"},[a("span",{staticClass:"bold"},[s._v(" "+s._s(s.buyerOrderIndicator.totalSuccessRate)+"% ")])])])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("div",{staticClass:"label"},[s._v(" "+s._s(s.buyerOrderIndicator.range)+"日平均放币时间 ")]),a("div",{staticClass:"value"},[s._v(" < "),a("span",{staticClass:"bold"},[s._v(" "+s._s(s.buyerOrderIndicator.sellerAvgTime)+" ")]),s._v(" 分钟 ")])]),a("div",{staticClass:"col"},[a("div",{staticClass:"label"},[s._v(" "+s._s(s.buyerOrderIndicator.range)+"日平均付款时间 ")]),a("div",{staticClass:"value"},[s._v(" < "),a("span",{staticClass:"bold"},[s._v(" "+s._s(s.buyerOrderIndicator.buyerAvgTime)+" ")]),s._v(" 分钟 ")])])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("div",{staticClass:"label"},[s._v("买单")]),a("div",{staticClass:"value"},[a("span",{staticClass:"bold"},[s._v(" "+s._s(s.buyerOrderIndicator.buyerOrder)+" ")]),s._v(" 笔 ")])]),a("div",{staticClass:"col"},[a("div",{staticClass:"label"},[s._v("卖单")]),a("div",{staticClass:"value"},[a("span",{staticClass:"bold"},[s._v(" "+s._s(s.buyerOrderIndicator.sellerOrder)+" ")]),s._v(" 笔 ")])])])])]:a(s.componentsMapping[s.radio],{tag:"components",attrs:{hide:s.hide,payment:s.hide?void 0:s.sellerPayment,title:"卖方收款信息"}}),s.status==s.TRANSACTING_ORDER_STATUS.TRANSFERRED||s.status==s.TRANSACTING_ORDER_STATUS.SELLER_DID_NOT_RECEIVE&&!s.isCountdownEnd||s.status==s.TRANSACTING_ORDER_STATUS.DISPUTING?[a("van-image",{staticClass:"certificationImage",attrs:{src:s.$root.getImageUrl(s.orderInfo.voucher),fit:"contain"},on:{click:function(t){s.previewImage(s.$root.getImageUrl(s.orderInfo.voucher))}}})]:s._e(),s.status==s.TRANSACTING_ORDER_STATUS.WAITING_FOR_TRANSFER||s.status==s.TRANSACTING_ORDER_STATUS.TRANSFERRED?[a("div",{staticClass:"warning"},[s._v(" 1.请认真核对买方付款信息，如「到款信息与买方付款信息不一 致」或「未收到付款」千万不要放行您的数字货币，一旦确认我已 收到款后转币给您造成的损失平台概不负责 ")]),a("div",{staticClass:"warning"},[s._v("2.收到买方真实付款后点击「确认转币」")])]:s._e()],a("div",{staticClass:"btns"},[s.status==s.TRANSACTING_ORDER_STATUS.BUYER_REQUEST?[a("van-button",{staticClass:"danger block",on:{click:s.cancel_transaction}},[s._v(" 取消交易 ")]),a("van-button",{staticClass:"primary block",on:{click:s.start_transaction}},[s._v(" 开始交易 ")])]:s._e(),s.status==s.TRANSACTING_ORDER_STATUS.WAITING_FOR_TRANSFER||s.status==s.TRANSACTING_ORDER_STATUS.TRANSFERRED?[a("van-button",{staticClass:"danger block",class:{disabled:s.status!=s.TRANSACTING_ORDER_STATUS.TRANSFERRED},on:{click:s.did_not_received}},[s._v(" 未收到转账 ")]),a("van-button",{staticClass:"primary block",class:{disabled:s.status!=s.TRANSACTING_ORDER_STATUS.TRANSFERRED},on:{click:s.confirm_transfer}},[s._v(" 确认转币 ")])]:s._e(),s.status==s.TRANSACTING_ORDER_STATUS.DISPUTING?[a("van-button",{staticClass:"primary block",on:{click:s.$root.openCustomerService}},[s._v(" 联系客服 ")])]:s._e()],2),a("van-dialog",{staticClass:"applyDialog",attrs:{"confirm-button-color":"#6F59FE","confirm-button-text":"提交申诉","show-cancel-button":"",title:"请简要描述您的申诉内容"},model:{value:s.show_apply,callback:function(t){s.show_apply=t},expression:"show_apply"}},[a("van-field",{attrs:{autocomplete:"new-password",autosize:"",maxlength:"50",placeholder:"0/50",rows:"3","show-word-limit":"",type:"textarea"},model:{value:s.applyReason,callback:function(t){s.applyReason=t},expression:"applyReason"}})],1),a("van-dialog",{staticClass:"applyDialog",class:{disabled:!s.enable_receive_transfer_dialog},attrs:{"confirm-button-color":"#6f59fe","confirm-button-text":s.enable_receive_transfer_dialog?"是":s.countdown_time+"s","cancel-button-text":"否","show-cancel-button":"",title:"重要提醒","before-close":s.confirmed_transfer},on:{close:function(t){s.enable_receive_transfer_dialog=!1}},model:{value:s.show_receive_transfer_confirm,callback:function(t){s.show_receive_transfer_confirm=t},expression:"show_receive_transfer_confirm"}},[s._v(" 请仔细核对您的收款账户"),a("span",{staticStyle:{color:"#FB2222","font-weight":"bold"}},[s._v("「是否收到款」")]),s._v("， "),a("span",{staticStyle:{color:"#FB2222","font-weight":"bold"}},[s._v("「收款金额」")]),s._v("是否与您的卖币金额一致 "),s.show_receive_transfer_confirm?a("van-count-down",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{time:"5000",format:"ss"},on:{finish:s.countdownFinish,change:s.countdownChange}}):s._e()],1)],2)},n=[],r=e(39873),o=e(7067),i=(e(32564),e(83040),e(86947)),c=e(41360),l=e(21288),u=e(54025),d=e(4588),_=e(39766),v=e(89828),f={components:{BankPaymentInfo:l.JF,WechatPaymentInfo:l.Ey,AliPaymentInfo:l.q$},mixins:[v.RY],data:function(){var t;return{PAYMENT_METHOD:i.hL,STATUS_TYPE:i.Z2,STEP:i.g0,TRANSACTING_ORDER_STATUS:i.eD,status:i.eD.HANGING,countdown:1,isTimeOut:!1,show_apply:!1,applyReason:"",loading:!1,radio:"",orderInfo:{},buyerPayment:{},sellerPayment:{},buyerOrderIndicator:{},componentsMapping:(t={},(0,o.Z)(t,i.hL.BANK,"BankPaymentInfo"),(0,o.Z)(t,i.hL.ALI,"AliPaymentInfo"),(0,o.Z)(t,i.hL.WE_CHAT,"WechatPaymentInfo"),t),show_receive_transfer_confirm:!1,enable_receive_transfer_dialog:!1,countdown_time:0}},computed:{hide:function(){return!(this.status===this.TRANSACTING_ORDER_STATUS.TRANSFERRED&&!this.isCountdownEnd||this.status===this.TRANSACTING_ORDER_STATUS.DISPUTING)},isCountdownEnd:function(){return this.countdown<=0},stepsActive:function(){return this.STEP[this.status]},isTimeoutDisputing:function(){return!(this.status!=this.TRANSACTING_ORDER_STATUS.DISPUTING||!this.isTimeOut)},payments:function(){return this.$root.parsePayments(this.orderInfo.paymentType)},isSystemBuyer:function(){return"System"===this.orderInfo.buyerType}},created:function(){this.load(),this.$root.$emit("root:set-topbar",["left-back","customer-service"])},beforeDestroy:function(){clearTimeout(this.timer)},methods:{transactingOrderStatus:function(){var t;return(t=this.$options.filters).transactingOrderStatus.apply(t,arguments)},start_transaction:function(){var t=this;(0,c.H9)().then((function(){(0,u.N8)({orderId:t.$route.params.id},t.ApiPath).then((function(s){var e=s.ok,a=s.msg;e?(t.$toast.success(a),t.status=i.eD.WAITING_FOR_TRANSFER,t.load()):t.$toast.fail(a)}))}))},cancel_transaction:function(){var t=this;(0,u.y6)(void 0,this.ApiPath).then((function(s){var e=s.ok,a=s.data,n=s.msg;e?(0,c.VN)(a.allowedCancelsOrderDailyCount-a.cancelsOrderDailyCount,a.allowedCancelsOrderDailyCount).then((function(){(0,u.CI)({orderId:t.$route.params.id},t.ApiPath).then((function(s){var e=s.ok,a=s.msg;e?(t.$toast.success(a),t.status=i.eD.SELLER_CANCELED_DEAL,t.load()):t.$toast.fail(a)}))})):t.$toast.fail(n)}))},did_not_received:function(){var t=this;(0,c.EQ)().then((function(){(0,u.Ej)({orderId:t.$route.params.id},t.ApiPath).then((function(s){var e=s.ok,a=s.msg;e?(t.$toast.success(a),t.status=i.eD.SELLER_DID_NOT_RECEIVE,t.load()):t.$toast.fail(a)}))}))},confirmed_transfer:function(t,s){var e=this;return(0,r.Z)(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(s(),"confirm"!==t){a.next=11;break}return a.next=4,(0,_.x)(e);case 4:return n=a.sent,a.next=7,(0,_.D)(e);case 7:if(r=a.sent,n&&r){a.next=10;break}return a.abrupt("return");case 10:(0,u.XW)({orderId:e.$route.params.id,securePassword:n},e.ApiPath).then((function(t){var s=t.ok,a=t.msg;s?(e.$toast.success(a),e.status=i.eD.DEAL,e.load()):e.$toast.fail(a)}));case 11:case"end":return a.stop()}}),a)})))()},countdownChange:function(t){this.countdown_time=t.seconds},countdownFinish:function(){this.enable_receive_transfer_dialog=!0},confirm_transfer:function(){this.show_receive_transfer_confirm=!0},load:function(){this.loadDetails(this.$route.params.id)},loadDetails:function(t){var s=this;this.loading||(this.loading=!0,(0,u.fW)({orderId:t},this.ApiPath).then((function(t){var e=t.ok,a=t.msg,n=t.data;s.loading=!1,e?(clearTimeout(s.timer),s.orderInfo=n.order,s.sellerPayment=n.sellerPayment,s.buyerPayment=n.buyerPayment,s.radio=n.order.paymentType,s.buyerOrderIndicator=n.buyerOrderIndicator,s.orderInfo.appeal>0?(s.status=i.eD.DISPUTING,s.orderInfo.status===i.eD.TIME_OVER&&(s.isTimeOut=!0)):s.status=s.orderInfo.status,n.currentStateExpireTime&&(n.currentStateExpireTime.expire?s.countdown=1e3*n.currentStateExpireTime.expire-s.$root.getServerTime():s.countdown=0),s.refreshStatus()):s.$toast.fail(a)})))},refreshStatus:function(){var t=this;this.timer=setTimeout((function(){(0,u.dF)({orderId:t.$route.params.id},t.ApiPath).then((function(s){var e=s.ok,a=s.data;if(t.refreshStatus(),e){var n=t.status;t.orderInfo.appeal>0?(t.status=i.eD.DISPUTING,a.status===i.eD.TIME_OVER&&(t.isTimeOut=!0)):t.status=a.status,t.status!==n&&t.loadDetails(t.orderInfo.orderId)}}))}),1e4)},onCountdownFinish:function(){this.load()},previewImage:function(t){(0,d.Z)([t])}}},T=f,p=e(1001),m=(0,p.Z)(T,a,n,!1,null,null,null),S=m.exports},39766:function(t,s,e){e.d(s,{D:function(){return o},x:function(){return r}});var a=e(39873),n=(e(83040),e(41539),e(32564),e(53045)),r=function(t){return t.$toast("请输入资金密码"),new Promise((function(s,e){t.$root.showPassowordKeyboard=!0,t.$root.$once("root:global-password",function(){var t=(0,a.Z)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",s(e));case 1:case"end":return t.stop()}}),t)})));return function(s){return t.apply(this,arguments)}}())}))},o=function(t){return t.$root.userInfo&&t.$root.userInfo.isGoogleAuthenticator?(t.$toast("请输入Google安全码"),new Promise((function(s,e){setTimeout((function(){t.$root.showPassowordKeyboard=!0,t.$root.$once("root:global-password",function(){var e=(0,a.Z)(regeneratorRuntime.mark((function e(a){var r,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a&&"close-by-route-change"!==a){e.next=2;break}return e.abrupt("return",s(!1));case 2:return e.next=4,(0,n.Wg)({safeCode:a});case 4:r=e.sent,o=r.ok,i=r.msg,o?s(!0):(s(!1),t.$toast.fail(i));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),0)}))):Promise.resolve(!0)}},41360:function(t,s,e){e.d(s,{EQ:function(){return i},H9:function(){return r},VN:function(){return o}});e(41539),e(92222);var a=e(60026),n=function(t,s){return new Promise((function(e,n){a.Z.confirm({title:t,message:s,confirmButtonText:"是",cancelButtonText:"否",confirmButtonColor:"#6f59fe",allowHtml:!0,beforeClose:function(t,s){s(),"confirm"===t?e():n()}})["catch"]((function(t){}))}))},r=function(){return n("是否开始交易","<div>\n开始交易后可在“交易记录”，“订单”中\n「我的卖单」完成后续操作\n</div>")},o=function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return n("是否取消该笔交易",'<div>\n      <div class="tip">\n        提示：\n      </div>\n      <div>\n          1.如果你在一天内取消<span style="color:#FB2222">'.concat(s,'次</span>订单，当天你的账户将会被停止买卖。\n      </div>\n      <div class="al-c">\n          今日还可取消\n          <span style="color:#FB2222">').concat(t,"次</span>\n          订单，请谨慎操作\n      </div>\n    </div>\n"))},i=function(){return n("是否未收到转账",'请再次确认您的收款账户是否未收到转账，\n如发现\n<span style="color:#FB2222">恶意不确认转币</span>\n可能会面临\n<span style="color:#FB2222">「永久封号」</span>\n处理')}}}]);
//# sourceMappingURL=7152.3a58a45a.js.map