{"version":3,"file":"js/5788.cee47844.js","mappings":"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","sources":["webpack://ez_pay/./src/views/pay_order/index.vue?0b2e","webpack://ez_pay/src/views/pay_order/index.vue","webpack://ez_pay/./src/views/pay_order/index.vue?37c5","webpack://ez_pay/./src/views/pay_order/index.vue","webpack://ez_pay/./src/vendor/globalVerify.js"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page page-pay_order\"},[_c('div',{staticClass:\"orderNumber\"},[_vm._v(\"订单编号：\"+_vm._s(_vm.$route.query.orderNo))]),_c('div',{staticClass:\"amountBox\"},[_c('div',{staticClass:\"amount\"},[_vm._v(_vm._s(_vm.$route.query.amount))]),_c('div',{staticClass:\"amount-icon\"})]),_c('div',{staticClass:\"tip\"},[_vm._v(\"支付金额(V币)\")]),_c('div',{staticClass:\"password\"},[_c('div',{staticClass:\"label\"},[_vm._v(\"支付密码\")]),_c('div',[_c('van-password-input',{attrs:{\"focused\":_vm.showKeyboard,\"value\":_vm.value},on:{\"focus\":function($event){_vm.showKeyboard = true}}})],1)]),_c('van-button',{staticClass:\"primary block\",attrs:{\"loading\":_vm.payLoading,\"loading-text\":\"请求支付中...\"},on:{\"click\":_vm.pay}},[_vm._v(\" 支付 \")]),_c('van-number-keyboard',{staticClass:\"safetyKeyboard\",attrs:{\"show\":_vm.showKeyboard,\"close-button-text\":\"完成\",\"safe-area-inset-bottom\":\"\",\"title\":\"支付安全键盘\"},on:{\"blur\":function($event){_vm.showKeyboard = false}},model:{value:(_vm.value),callback:function ($$v) {_vm.value=$$v},expression:\"value\"}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"page page-pay_order\">\n    <div class=\"orderNumber\">订单编号：{{ $route.query.orderNo }}</div>\n    <div class=\"amountBox\">\n      <div class=\"amount\">{{ $route.query.amount }}</div>\n      <div class=\"amount-icon\"></div>\n    </div>\n    <div class=\"tip\">支付金额(V币)</div>\n    <div class=\"password\">\n      <div class=\"label\">支付密码</div>\n      <div>\n        <van-password-input :focused=\"showKeyboard\" :value=\"value\" @focus=\"showKeyboard = true\"/>\n      </div>\n    </div>\n\n    <van-button :loading=\"payLoading\" class=\"primary block\" loading-text=\"请求支付中...\"\n                @click=\"pay\">\n      支付\n    </van-button>\n    <van-number-keyboard v-model=\"value\" :show=\"showKeyboard\" class=\"safetyKeyboard\"\n                         close-button-text=\"完成\"\n                         safe-area-inset-bottom title=\"支付安全键盘\" @blur=\"showKeyboard = false\"/>\n  </div>\n</template>\n\n<script>\nimport {payUserDeposit} from \"@/apis/user\";\nimport {NumberKeyboard, PasswordInput} from 'vant'\nimport {verifyGoogleAuth} from \"@/vendor/globalVerify\";\n\nexport default {\n  components: {\n    [NumberKeyboard.name]: NumberKeyboard,\n    [PasswordInput.name]: PasswordInput,\n  },\n  data() {\n    return {\n      value: \"\",\n      showKeyboard: false,\n      payLoading: false\n    };\n  },\n  created() {\n    this.$root.$emit(\"root:set-topbar\", [\"left-back\"]);\n  },\n  methods: {\n    async pay() {\n      if (this.payLoading) return;\n      if (this.value.length < 6) return this.$toast.fail(\"请输入6位数字密码\")\n\n      const isPassed = await verifyGoogleAuth(this)\n      if(!isPassed) return\n\n      this.payLoading = true\n      try {\n        const {ok, msg} = await payUserDeposit({\n          orderNo: this.$route.query.orderNo,\n          securePassword: this.value,\n        })\n        if (ok) {\n          this.$toast.success(msg);\n          this.$root.fetchUserInfo();\n          this.$router.replace('/');\n        } else {\n          this.$toast.fail(msg);\n        }\n      } catch (error) {\n        window.alert(error)\n      } finally {\n        this.payLoading = false;\n      }\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\">\n.page-pay_order {\n  overflow-y: auto;\n  padding: 10px 12px;\n\n  .orderNumber {\n    font-size: 16px;\n    color: #333;\n    margin-top: 25px;\n    text-align: center;\n    font-weight: 600;\n  }\n\n  .amountBox {\n    margin-top: 51px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n\n    .amount {\n      font-size: 30px;\n      color: $theme;\n      font-weight: 600;\n    }\n\n    .amount-icon {\n      width: 24.5px;\n      height: 24.5px;\n      background-image: url(\"@/assets/icons/unit@3x.png\");\n      background-size: 100% 100%;\n      margin-left: 10px;\n    }\n  }\n\n  .tip {\n    margin-top: 12px;\n    text-align: center;\n    font-size: 14px;\n    font-weight: 600;\n  }\n\n  .van-password-input {\n    margin: 0;\n  }\n\n  .password {\n    padding: 12px;\n    margin-top: 60px;\n\n    .label {\n      margin-bottom: 20px;\n      font-size: 14px;\n      color: #333;\n      font-weight: 600;\n    }\n  }\n\n  .safetyKeyboard {\n    .van-number-keyboard__header {\n      text-align: center;\n    }\n  }\n\n  .primary.block {\n    margin-top: 100px;\n    margin-bottom: 200px;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=d210fc74&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import {checkGoogleAuthenticator} from \"@/apis/user\";\n\nexport const verifySecuretedCode = vm => {\n  vm.$toast('请输入资金密码')\n  return new Promise((resolve, reject) => {\n    vm.$root.showPassowordKeyboard = true\n    vm.$root.$once('root:global-password', async code => resolve(code))\n  })\n}\n\nexport const verifyGoogleAuth = (vm) => {\n  if (vm.$root.userInfo && vm.$root.userInfo.isGoogleAuthenticator) {\n    vm.$toast('请输入Google安全码')\n    return new Promise((resolve, reject) => {\n      setTimeout(() => {\n        vm.$root.showPassowordKeyboard = true\n        vm.$root.$once('root:global-password', async code => {\n          if (!code || code === 'close-by-route-change') return resolve(false)\n          const {ok, msg} = await checkGoogleAuthenticator({safeCode: code})\n          if (ok) {\n            resolve(true)\n          } else {\n            resolve(false)\n            vm.$toast.fail(msg)\n          }\n        })\n      }, 0)\n    })\n  } else {\n    return Promise.resolve(true)\n  }\n\n}\n"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_s","$route","query","orderNo","amount","attrs","showKeyboard","value","on","$event","payLoading","pay","model","callback","$$v","expression","staticRenderFns","components","NumberKeyboard","PasswordInput","data","created","methods","_this","_context","verifyGoogleAuth","isPassed","payUserDeposit","securePassword","_yield$payUserDeposit","ok","msg","window","component","verifySecuretedCode","vm","$toast","Promise","resolve","reject","$root","showPassowordKeyboard","$once","_ref","_asyncToGenerator","regeneratorRuntime","mark","_callee","code","wrap","prev","next","abrupt","stop","_x","apply","arguments","userInfo","isGoogleAuthenticator","setTimeout","_ref2","_callee2","_yield$checkGoogleAut","_context2","checkGoogleAuthenticator","safeCode","sent","fail","_x2"],"sourceRoot":""}