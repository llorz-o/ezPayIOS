"use strict";(self["webpackChunkez_pay"]=self["webpackChunkez_pay"]||[]).push([[9828],{39828:function(t,e,n){n.r(e),n.d(e,{default:function(){return U}});var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page page-user-bill"},[n("div",{staticClass:"hd border_bottom_1px"},[n("div",{staticClass:"item"},[t._v("账变时间")]),n("div",{staticClass:"item"},[n("van-dropdown-menu",[n("van-dropdown-item",{ref:"bill_type",attrs:{title:"账变类型"}},[n("van-radio-group",{on:{change:t.onChange},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},t._l(t.types,(function(e,i){return n("van-radio",{key:i,staticClass:"btn",attrs:{name:i}},[n("van-button",{staticClass:"btn",attrs:{slot:"icon"},on:{click:function(e){return t.clearSelect(i)}},slot:"icon"},[t._v(" "+t._s(e)+" ")])],1)})),1)],1)],1)],1),n("div",{staticClass:"item"},[t._v("账变金额")])]),n("van-list",{ref:"list",attrs:{"error-text":t.errorText,error:t.error,finished:t.finished,"finished-text":"暂无更多数据"},on:{"update:error":function(e){t.error=e},load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e,i){return n("div",{key:i,staticClass:"row border_bottom_1px",on:{click:function(n){return t.$router.push("/user_bill_detail?id="+e.id)}}},[n("div",{staticClass:"item"},[t._v(" "+t._s(t._f("dateFormat")(e.createTime,"Y/M/D h:m:s"))+" ")]),n("div",{staticClass:"item"},[t._v(t._s(e.type_name))]),n("div",{staticClass:"item"},[t._v(t._s(parseFloat(e.amount).toFixed(2)))])])})),0),n("van-action-sheet",{attrs:{actions:t.actions,"safe-area-inset-bottom":""},on:{select:t.onSelect},model:{value:t.showAction,callback:function(e){t.showAction=e},expression:"showAction"}}),n("van-calendar",{attrs:{"max-date":t.maxDate,"min-date":t.minDate,"safe-area-inset-bottom":"",type:"range"},on:{confirm:t.onConfirm},model:{value:t.showCalendar,callback:function(e){t.showCalendar=e},expression:"showCalendar"}})],1)},o=[],r=n(26982),a=n(49749),s=n(37174),l=n(7067),h=(n(68309),n(83710),n(32564),n(9653),n(5212),n(41539),n(21249),n(85827),n(89554),n(54747),n(40561),n(92222),n(63272)),u=n(71256);function c(t){return"[object Date]"===Object.prototype.toString.call(t)&&!(0,u.i)(t.getTime())}var f=n(32758),d=(n(79753),n(91064)),m=(0,d.d)("calendar"),p=m[0],g=m[1],v=m[2];function y(t){return v("monthTitle",t.getFullYear(),t.getMonth()+1)}function D(t,e){var n=t.getFullYear(),i=e.getFullYear(),o=t.getMonth(),r=e.getMonth();return n===i?o===r?0:o>r?1:-1:n>i?1:-1}function w(t,e){var n=D(t,e);if(0===n){var i=t.getDate(),o=e.getDate();return i===o?0:i>o?1:-1}return n}function b(t,e){return t=new Date(t),t.setDate(t.getDate()+e),t}function k(t){return b(t,-1)}function C(t){return b(t,1)}function S(t){var e=t[0].getTime(),n=t[1].getTime();return(n-e)/864e5+1}function T(t){return new Date(t)}function $(t){return Array.isArray(t)?t.map((function(t){return null===t?t:T(t)})):T(t)}var x=n(97400),M=n(2692),_=n(58509),B=n(24074);n(91058),n(47042);function I(t,e){return 32-new Date(t,e-1,32).getDate()}var O=(0,d.d)("calendar-month"),R=O[0],F=R({props:{date:Date,type:String,color:String,minDate:Date,maxDate:Date,showMark:Boolean,rowHeight:[Number,String],formatter:Function,lazyRender:Boolean,currentDate:[Date,Array],allowSameDay:Boolean,showSubtitle:Boolean,showMonthTitle:Boolean,firstDayOfWeek:Number},data:function(){return{visible:!1}},computed:{title:function(){return y(this.date)},rowHeightWithUnit:function(){return(0,B.N)(this.rowHeight)},offset:function(){var t=this.firstDayOfWeek,e=this.date.getDay();return t?(e+7-this.firstDayOfWeek)%7:e},totalDay:function(){return I(this.date.getFullYear(),this.date.getMonth()+1)},shouldRender:function(){return this.visible||!this.lazyRender},placeholders:function(){for(var t=[],e=Math.ceil((this.totalDay+this.offset)/7),n=1;n<=e;n++)t.push({type:"placeholder"});return t},days:function(){for(var t=[],e=this.date.getFullYear(),n=this.date.getMonth(),i=1;i<=this.totalDay;i++){var o=new Date(e,n,i),r=this.getDayType(o),a={date:o,type:r,text:i,bottomInfo:this.getBottomInfo(r)};this.formatter&&(a=this.formatter(a)),t.push(a)}return t}},methods:{getHeight:function(){var t;return(null==(t=this.$el)?void 0:t.getBoundingClientRect().height)||0},scrollIntoView:function(t){var e=this.$refs,n=e.days,i=e.month,o=this.showSubtitle?n:i,r=o.getBoundingClientRect().top-t.getBoundingClientRect().top+t.scrollTop;(0,f.QU)(t,r)},getMultipleDayType:function(t){var e=this,n=function(t){return e.currentDate.some((function(e){return 0===w(e,t)}))};if(n(t)){var i=k(t),o=C(t),r=n(i),a=n(o);return r&&a?"multiple-middle":r?"end":a?"start":"multiple-selected"}return""},getRangeDayType:function(t){var e=this.currentDate,n=e[0],i=e[1];if(!n)return"";var o=w(t,n);if(!i)return 0===o?"start":"";var r=w(t,i);return 0===o&&0===r&&this.allowSameDay?"start-end":0===o?"start":0===r?"end":o>0&&r<0?"middle":void 0},getDayType:function(t){var e=this.type,n=this.minDate,i=this.maxDate,o=this.currentDate;return w(t,n)<0||w(t,i)>0?"disabled":null!==o?"single"===e?0===w(t,o)?"selected":"":"multiple"===e?this.getMultipleDayType(t):"range"===e?this.getRangeDayType(t):void 0:void 0},getBottomInfo:function(t){if("range"===this.type){if("start"===t||"end"===t)return v(t);if("start-end"===t)return v("startEnd")}},getDayStyle:function(t,e){var n={height:this.rowHeightWithUnit};return"placeholder"===t?(n.width="100%",n):(0===e&&(n.marginLeft=100*this.offset/7+"%"),this.color&&("start"===t||"end"===t||"start-end"===t||"multiple-selected"===t||"multiple-middle"===t?n.background=this.color:"middle"===t&&(n.color=this.color)),n)},genTitle:function(){var t=this.$createElement;if(this.showMonthTitle)return t("div",{class:g("month-title")},[this.title])},genMark:function(){var t=this.$createElement;if(this.showMark&&this.shouldRender)return t("div",{class:g("month-mark")},[this.date.getMonth()+1])},genDays:function(){var t=this.$createElement,e=this.shouldRender?this.days:this.placeholders;return t("div",{ref:"days",attrs:{role:"grid"},class:g("days")},[this.genMark(),e.map(this.genDay)])},genTopInfo:function(t){var e=this.$createElement,n=this.$scopedSlots["top-info"];if(t.topInfo||n)return e("div",{class:g("top-info")},[n?n(t):t.topInfo])},genBottomInfo:function(t){var e=this.$createElement,n=this.$scopedSlots["bottom-info"];if(t.bottomInfo||n)return e("div",{class:g("bottom-info")},[n?n(t):t.bottomInfo])},genDay:function(t,e){var n=this,i=this.$createElement,o=t.type,r=this.getDayStyle(o,e),a="disabled"===o,s=function(){a||n.$emit("click",t)};return"selected"===o?i("div",{attrs:{role:"gridcell",tabindex:-1},style:r,class:[g("day"),t.className],on:{click:s}},[i("div",{class:g("selected-day"),style:{width:this.rowHeightWithUnit,height:this.rowHeightWithUnit,background:this.color}},[this.genTopInfo(t),t.text,this.genBottomInfo(t)])]):i("div",{attrs:{role:"gridcell",tabindex:a?null:-1},style:r,class:[g("day",o),t.className],on:{click:s}},[this.genTopInfo(t),t.text,this.genBottomInfo(t)])}},render:function(){var t=arguments[0];return t("div",{class:g("month"),ref:"month"},[this.genTitle(),this.genDays()])}}),W=(0,d.d)("calendar-header"),E=W[0],Y=E({props:{title:String,subtitle:String,showTitle:Boolean,showSubtitle:Boolean,firstDayOfWeek:Number},methods:{genTitle:function(){var t=this.$createElement;if(this.showTitle){var e=this.slots("title")||this.title||v("title");return t("div",{class:g("header-title")},[e])}},genSubtitle:function(){var t=this.$createElement;if(this.showSubtitle)return t("div",{class:g("header-subtitle")},[this.subtitle])},genWeekDays:function(){var t=this.$createElement,e=v("weekdays"),n=this.firstDayOfWeek,i=[].concat(e.slice(n,7),e.slice(0,n));return t("div",{class:g("weekdays")},[i.map((function(e){return t("span",{class:g("weekday")},[e])}))])}},render:function(){var t=arguments[0];return t("div",{class:g("header")},[this.genTitle(),this.genSubtitle(),this.genWeekDays()])}}),H=p({props:{title:String,color:String,value:Boolean,readonly:Boolean,formatter:Function,rowHeight:[Number,String],confirmText:String,rangePrompt:String,defaultDate:[Date,Array],getContainer:[String,Function],allowSameDay:Boolean,confirmDisabledText:String,type:{type:String,default:"single"},round:{type:Boolean,default:!0},position:{type:String,default:"bottom"},poppable:{type:Boolean,default:!0},maxRange:{type:[Number,String],default:null},lazyRender:{type:Boolean,default:!0},showMark:{type:Boolean,default:!0},showTitle:{type:Boolean,default:!0},showConfirm:{type:Boolean,default:!0},showSubtitle:{type:Boolean,default:!0},closeOnPopstate:{type:Boolean,default:!0},closeOnClickOverlay:{type:Boolean,default:!0},safeAreaInsetBottom:{type:Boolean,default:!0},minDate:{type:Date,validator:c,default:function(){return new Date}},maxDate:{type:Date,validator:c,default:function(){var t=new Date;return new Date(t.getFullYear(),t.getMonth()+6,t.getDate())}},firstDayOfWeek:{type:[Number,String],default:0,validator:function(t){return t>=0&&t<=6}}},inject:{vanPopup:{default:null}},data:function(){return{subtitle:"",currentDate:this.getInitialDate()}},computed:{months:function(){var t=[],e=new Date(this.minDate);e.setDate(1);do{t.push(new Date(e)),e.setMonth(e.getMonth()+1)}while(1!==D(e,this.maxDate));return t},buttonDisabled:function(){var t=this.type,e=this.currentDate;if(e){if("range"===t)return!e[0]||!e[1];if("multiple"===t)return!e.length}return!e},dayOffset:function(){return this.firstDayOfWeek?this.firstDayOfWeek%7:0}},watch:{value:"init",type:function(){this.reset()},defaultDate:function(t){this.currentDate=t,this.scrollIntoView()}},mounted:function(){var t;this.init(),null==(t=this.vanPopup)||t.$on("opened",this.onScroll)},activated:function(){this.init()},methods:{reset:function(t){void 0===t&&(t=this.getInitialDate()),this.currentDate=t,this.scrollIntoView()},init:function(){var t=this;this.poppable&&!this.value||this.$nextTick((function(){t.bodyHeight=Math.floor(t.$refs.body.getBoundingClientRect().height),t.onScroll(),t.scrollIntoView()}))},scrollToDate:function(t){var e=this;(0,h.Wn)((function(){var n=e.value||!e.poppable;t&&n&&(e.months.some((function(n,i){if(0===D(n,t)){var o=e.$refs,r=o.body,a=o.months;return a[i].scrollIntoView(r),!0}return!1})),e.onScroll())}))},scrollIntoView:function(){var t=this.currentDate;if(t){var e="single"===this.type?t:t[0];this.scrollToDate(e)}},getInitialDate:function(){var t=this.type,e=this.minDate,n=this.maxDate,i=this.defaultDate;if(null===i)return i;var o=new Date;if(-1===w(o,e)?o=e:1===w(o,n)&&(o=n),"range"===t){var r=i||[],a=r[0],s=r[1];return[a||o,s||C(o)]}return"multiple"===t?i||[o]:i||o},onScroll:function(){var t=this.$refs,e=t.body,n=t.months,i=(0,f.cx)(e),o=i+this.bodyHeight,r=n.map((function(t){return t.getHeight()})),a=r.reduce((function(t,e){return t+e}),0);if(!(o>a&&i>0)){for(var s,l=0,h=[-1,-1],u=0;u<n.length;u++){var c=l<=o&&l+r[u]>=i;c&&(h[1]=u,s||(s=n[u],h[0]=u),n[u].showed||(n[u].showed=!0,this.$emit("month-show",{date:n[u].date,title:n[u].title}))),l+=r[u]}n.forEach((function(t,e){t.visible=e>=h[0]-1&&e<=h[1]+1})),s&&(this.subtitle=s.title)}},onClickDay:function(t){if(!this.readonly){var e=t.date,n=this.type,i=this.currentDate;if("range"===n){if(!i)return void this.select([e,null]);var o=i[0],r=i[1];if(o&&!r){var a=w(e,o);1===a?this.select([o,e],!0):-1===a?this.select([e,null]):this.allowSameDay&&this.select([e,e],!0)}else this.select([e,null])}else if("multiple"===n){if(!i)return void this.select([e]);var s,l=this.currentDate.some((function(t,n){var i=0===w(t,e);return i&&(s=n),i}));if(l){var h=i.splice(s,1),u=h[0];this.$emit("unselect",T(u))}else this.maxRange&&i.length>=this.maxRange?(0,_.Z)(this.rangePrompt||v("rangePrompt",this.maxRange)):this.select([].concat(i,[e]))}else this.select(e,!0)}},togglePopup:function(t){this.$emit("input",t)},select:function(t,e){var n=this,i=function(t){n.currentDate=t,n.$emit("select",$(n.currentDate))};if(e&&"range"===this.type){var o=this.checkRange(t);if(!o)return void(this.showConfirm?i([t[0],b(t[0],this.maxRange-1)]):i(t))}i(t),e&&!this.showConfirm&&this.onConfirm()},checkRange:function(t){var e=this.maxRange,n=this.rangePrompt;return!(e&&S(t)>e)||((0,_.Z)(n||v("rangePrompt",e)),!1)},onConfirm:function(){this.$emit("confirm",$(this.currentDate))},genMonth:function(t,e){var n=this.$createElement,i=0!==e||!this.showSubtitle;return n(F,{ref:"months",refInFor:!0,attrs:{date:t,type:this.type,color:this.color,minDate:this.minDate,maxDate:this.maxDate,showMark:this.showMark,formatter:this.formatter,rowHeight:this.rowHeight,lazyRender:this.lazyRender,currentDate:this.currentDate,showSubtitle:this.showSubtitle,allowSameDay:this.allowSameDay,showMonthTitle:i,firstDayOfWeek:this.dayOffset},scopedSlots:{"top-info":this.$scopedSlots["top-info"],"bottom-info":this.$scopedSlots["bottom-info"]},on:{click:this.onClickDay}})},genFooterContent:function(){var t=this.$createElement,e=this.slots("footer");if(e)return e;if(this.showConfirm){var n=this.buttonDisabled?this.confirmDisabledText:this.confirmText;return t(M.Z,{attrs:{round:!0,block:!0,type:"danger",color:this.color,disabled:this.buttonDisabled,nativeType:"button"},class:g("confirm"),on:{click:this.onConfirm}},[n||v("confirm")])}},genFooter:function(){var t=this.$createElement;return t("div",{class:g("footer",{unfit:!this.safeAreaInsetBottom})},[this.genFooterContent()])},genCalendar:function(){var t=this,e=this.$createElement;return e("div",{class:g()},[e(Y,{attrs:{title:this.title,showTitle:this.showTitle,subtitle:this.subtitle,showSubtitle:this.showSubtitle,firstDayOfWeek:this.dayOffset},scopedSlots:{title:function(){return t.slots("title")}}}),e("div",{ref:"body",class:g("body"),on:{scroll:this.onScroll}},[this.months.map(this.genMonth)]),this.genFooter()])}},render:function(){var t=this,e=arguments[0];if(this.poppable){var n,i=function(e){return function(){return t.$emit(e)}};return e(x.Z,{attrs:(n={round:!0,value:this.value},n["round"]=this.round,n["position"]=this.position,n["closeable"]=this.showTitle||this.showSubtitle,n["getContainer"]=this.getContainer,n["closeOnPopstate"]=this.closeOnPopstate,n["closeOnClickOverlay"]=this.closeOnClickOverlay,n),class:g("popup"),on:{input:this.togglePopup,open:i("open"),opened:i("opened"),close:i("close"),closed:i("closed")}},[this.genCalendar()])}return this.genCalendar()}}),P=n(53045),A=n(31581),z={components:(0,l.Z)({},H.name,H),data:function(){return{showAction:!1,actions:[{name:"今日",value:"today"},{name:"近三天",value:"d3"},{name:"近五天",value:"d5"},{name:"自定义",value:"custom"},{name:"取消",value:"cancel"}],minDate:new Date(2022,0,1),maxDate:new Date,types:{},form:{startTime:(0,A._7)().hour("0").minute("0").second("0").format("Y-M-D h:m:s"),endTime:(0,A._7)().hour("23").minute("59").second("59").format("Y-M-D h:m:s"),type:"",page:1,pageSize:20},list:[],loading:!1,error:!1,finished:!1,errorText:"加载失败，点击重试",showCalendar:!1}},created:function(){this.$root.$emit("root:set-topbar",["left-back","time-picker"],{down:!0,label:"今天",onClick:this.onClickTime}),this.loadChangeType()},methods:{onSelect:function(t){"custom"==t.value?this.showCalendar=!0:(this.$root.topConfig.label=t.name,this.$root.topConfig.down=!0,this.form.endTime=(0,A._7)().hour("23").minute("59").second("59").format("Y-M-D h:m:s"),"today"==t.value&&(this.form.startTime=(0,A._7)().hour("0").minute("0").second("0").format("Y-M-D h:m:s")),"d3"==t.value&&(this.form.startTime=(0,A._7)().day(-3).hour("0").minute("0").second("0").format("Y-M-D h:m:s")),"d5"==t.value&&(this.form.startTime=(0,A._7)().day(-5).hour("0").minute("0").second("0").format("Y-M-D h:m:s")),this.onChange()),this.showAction=!1},onConfirm:function(t){var e=(0,s.Z)(t,2),n=e[0],i=e[1];this.form.startTime=(0,A.vc)(n,"Y-M-D h:m:s"),this.form.endTime=(0,A._7)(i).hour("23").minute("59").second("59").format("Y-M-D h:m:s"),this.showCalendar=!1,this.$root.topConfig.label="自定义",this.$root.topConfig.down=!0,this.onChange()},onClickTime:function(){this.showAction=!0,this.$root.topConfig.down=!1},onLoad:function(){var t=this;(0,P.RI)(this.$root.$tls.processParams((0,a.Z)({},this.form),["shake"])).then((function(e){var n=e.ok,i=e.data,o=e.msg;if(n){var a;if(1===t.form.page)t.list=i.list;else(a=t.list).push.apply(a,(0,r.Z)(i.list));t.loading=!1,t.finished=t.form.page*t.form.pageSize>=i.total,t.form.page+=1}else t.error=!0,t.errorText=o,t.$toast.fail(o)}))},loadChangeType:function(){var t=this;(0,P.pO)().then((function(e){var n=e.ok,i=e.data,o=e.msg;n?t.types=i:t.$toast.fail(o)}))},onChange:function(){this.$refs.bill_type.toggle(!1),this.form.page=1,this.list=[],this.onLoad()},clearSelect:function(t){var e=this;this.form.type===t&&setTimeout((function(){return e.form.type=""}),50)}}},N=z,Z=n(1001),V=(0,Z.Z)(N,i,o,!1,null,null,null),U=V.exports}}]);
//# sourceMappingURL=9828.a21b9a30.js.map