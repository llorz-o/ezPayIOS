"use strict";(self["webpackChunkez_pay"]=self["webpackChunkez_pay"]||[]).push([[5205],{47804:function(t,e,r){r.d(e,{Z:function(){return u}});var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"level"},t._l(5,(function(e){var n;return r("div",{key:e,staticClass:"grade mini",class:(n={},n["g"+t.largeLevel+((5==e?0==t.levelModel:t.levelModel>=e||0==t.levelModel)?"l":"")]=!0,n)})})),0)},a=[],o=(r(9653),{name:"Level",props:{level:{type:Number,default:1}},computed:{levelModel:function(){return this.level%5},largeLevel:function(){return this.levelModel>=1?(this.level-this.levelModel)/5+1:this.level/5}}}),i=o,s=r(1001),c=(0,s.Z)(i,n,a,!1,null,null,null),u=c.exports},55074:function(t,e,r){r.d(e,{Z:function(){return u}});var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"virtual-payment",on:{click:function(e){return t.$emit("click")}}},[r("div",{staticClass:"icon",class:t.type}),r("div",{staticClass:"info"},["ali"==t.type?r("div",[t._v("支付宝账号："+t._s(t._f("safeText")(t.alipayAccount)))]):t._e(),"wechat"==t.type?r("div",[t._v("微信真实姓名："+t._s(t._f("safeText")(t.wxRealname)))]):t._e(),r("div",[t._v("姓名："+t._s(t._f("safeRealName")(t.realName)))])]),r("van-image",{staticClass:"qr",attrs:{src:t.$root.getImageUrl(t.receiptCode)}}),t._t("default")],2)},a=[],o={name:"VirtualPayment",props:{type:String,realName:String,wxRealname:String,alipayAccount:String,receiptCode:String}},i=o,s=r(1001),c=(0,s.Z)(i,n,a,!1,null,null,null),u=c.exports},75205:function(t,e,r){r.r(e),r.d(e,{default:function(){return h}});var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"page page-buy"},[r("div",{staticClass:"top-wrapper"},[r("div",{staticClass:"merchant",class:{split:!!t.orderInfo.isSplit}},[r("div",{staticClass:"left"},[r("van-image",{staticClass:"avatar",attrs:{src:t.$root.getImageUrl(t.orderInfo.sellerAvatar),round:""}},[r("div",{staticClass:"defaultAvatar size45",attrs:{slot:"error"},slot:"error"})]),r("div",{staticClass:"seller-info"},[r("div",{staticClass:"name"},[t._v(t._s(t.orderInfo.sellerNickname))]),r("Level",{attrs:{level:t.orderInfo.sellerCreditLevel}})],1)],1),r("div",{staticClass:"right"},[r("div",{staticClass:"label"},[t._v("可购买总额（V币）")]),r("div",{staticClass:"amount"},[t._v(t._s(t.orderInfo.validAmount))])])])]),r("div",{staticClass:"seller-credit-indicator"},[r("div",{staticClass:"title"},[t._v("卖方信用资讯")]),r("div",{staticClass:"row"},[r("div",{staticClass:"col"},[r("div",{staticClass:"label"},[t._v(t._s(t.orderInfo.sellerIndicator.range)+"日成单数")]),r("div",{staticClass:"value"},[r("span",{staticClass:"bold"},[t._v(" "+t._s(t.orderInfo.sellerIndicator.totalSuccessfulOrder)+" ")])])]),r("div",{staticClass:"col"},[r("div",{staticClass:"label"},[t._v(t._s(t.orderInfo.sellerIndicator.range)+"日成单率")]),r("div",{staticClass:"value"},[r("span",{staticClass:"bold"},[t._v(" "+t._s(t.orderInfo.sellerIndicator.totalSuccessRate)+"% ")])])])]),r("div",{staticClass:"row"},[r("div",{staticClass:"col"},[r("div",{staticClass:"label"},[t._v(" "+t._s(t.orderInfo.sellerIndicator.range)+"日平均放币时间 ")]),r("div",{staticClass:"value"},[t._v(" < "),r("span",{staticClass:"bold"},[t._v(" "+t._s(t.orderInfo.sellerIndicator.sellerAvgTime)+" ")]),t._v(" 分钟 ")])]),r("div",{staticClass:"col"},[r("div",{staticClass:"label"},[t._v(" "+t._s(t.orderInfo.sellerIndicator.range)+"日平均付款时间 ")]),r("div",{staticClass:"value"},[t._v(" < "),r("span",{staticClass:"bold"},[t._v(" "+t._s(t.orderInfo.sellerIndicator.buyerAvgTime)+" ")]),t._v(" 分钟 ")])])]),r("div",{staticClass:"row"},[r("div",{staticClass:"col"},[r("div",{staticClass:"label"},[t._v("买单")]),r("div",{staticClass:"value"},[r("span",{staticClass:"bold"},[t._v(" "+t._s(t.orderInfo.sellerIndicator.buyerOrder)+" ")]),t._v(" 笔 ")])]),r("div",{staticClass:"col"},[r("div",{staticClass:"label"},[t._v("卖单")]),r("div",{staticClass:"value"},[r("span",{staticClass:"bold"},[t._v(" "+t._s(t.orderInfo.sellerIndicator.sellerOrder)+" ")]),t._v(" 笔 ")])])])]),r("van-form",{staticClass:"gray-8",on:{submit:t.onSubmit}},[r("van-field",{attrs:{placeholder:t.orderInfo.minBuyEach+"～"+t.orderInfo.validAmount+"/V币",readonly:!t.orderInfo.isSplit,autocomplete:"new-password",label:"购买数量：",type:"number"},model:{value:t.form.amount,callback:function(e){t.$set(t.form,"amount",e)},expression:"form.amount"}}),r("van-cell",{staticClass:"payment",attrs:{title:"支付方式："}},[r("van-radio-group",{model:{value:t.form.paymentType,callback:function(e){t.$set(t.form,"paymentType",e)},expression:"form.paymentType"}},t._l(t.sellerPayments,(function(e,n){return r("van-radio",{key:n,staticClass:"btn",attrs:{disabled:!t.$root.validPayments[e],name:e}},[r("van-button",{staticClass:"btn",attrs:{slot:"icon","native-type":"button"},slot:"icon"},[r("span",{staticClass:"item",class:"pay"+e}),t._v(" "+t._s(t._f("paymentMethod")(e,"content"))+" ")])],1)})),1)],1),r("van-cell",[r("van-radio-group",{model:{value:t.form.buyerPaymentTypeId,callback:function(e){t.$set(t.form,"buyerPaymentTypeId",e)},expression:"form.buyerPaymentTypeId"}},[t._l(t.paymentChannel,(function(e,n){return[t.form.paymentType===t.PAYMENT_METHOD.BANK?[r("van-cell",{key:n,staticClass:"paymentChannel",attrs:{title:t.bankIdMappingName[e.bankId],value:t._f("safeBankNumber")(e.bankNo)},on:{click:function(r){t.form.buyerPaymentTypeId=e.id}},scopedSlots:t._u([{key:"right-icon",fn:function(){return[r("van-radio",{attrs:{name:e.id}})]},proxy:!0}],null,!0)})]:[r("VirtualPayment",t._b({key:n,attrs:{type:t._f("paymentMethod")(t.form.paymentType)},on:{click:function(r){t.form.buyerPaymentTypeId=e.id}}},"VirtualPayment",e,!1),[r("van-radio",{staticStyle:{"margin-left":"15px"},attrs:{name:e.id}})],1)]]}))],2)],1),r("van-button",{staticClass:"primary block",attrs:{"native-type":"submit"}},[t._v(" 确定购买 ")]),r("p",{staticClass:"tip"},[t._v("确认购买后如未自动跳转请到交易记录中查看我的买单")])],1)],1)},a=[],o=r(7067),i=r(49749),s=r(37174),c=(r(69826),r(41539),r(21249),r(69720),r(85827),r(83710),r(39714),r(74916),r(15306),r(92222),r(89554),r(54747),r(86947)),u=r(54025),l=r(47804),d=r(55074),m=r(89828),f={components:{Level:l.Z,VirtualPayment:d.Z},mixins:[m.RY],data:function(){return{PAYMENT_METHOD:c.hL,form:{amount:"",buyerPaymentTypeId:"",paymentType:""},orderInfo:{sellerIndicator:{}}}},computed:{sellerPayments:function(){return this.$root.parsePayments(this.orderInfo.paymentType)},paymentChannel:function(){var t=this;return(Object.entries(this.$root.payments).map((function(t){var e=(0,s.Z)(t,2),r=(e[0],e[1]);return r})).find((function(e){return e.type===t.form.paymentType}))||{}).list||[]},bankIdMappingName:function(){return this.$root.banks.reduce((function(t,e){return(0,i.Z)((0,i.Z)({},t),{},(0,o.Z)({},e.bankId,e.bankName))}),{})}},created:function(){this.$root.loadPayments(),this.loadOrderInfo(this.$route.params.id),this.$root.$emit("root:set-topbar",["left-back","customer-service"])},methods:{onSubmit:function(){var t=this;return this.form.amount?this.form.amount.toNumber()<this.orderInfo.minBuyEach.toNumber()?this.$toast.fail("购买数额不得小于最低可购买额".concat(this.orderInfo.minBuyEach)):this.form.amount.toNumber()>this.orderInfo.validAmount.toNumber()?this.$toast.fail("购买数额不得大于最高可购买额".concat(this.orderInfo.minBuyEach)):this.form.paymentType?this.form.buyerPaymentTypeId?void(0,u.an)(this.$root.$tls.processParams({pendingOrderId:this.orderInfo.pendingOrderId.toString(),amount:this.form.amount.toNumber(),buyerPaymentTypeId:this.form.buyerPaymentTypeId.toString(),paymentType:this.form.paymentType.toString()},["float","shake"]),this.BuyerApiPath).then((function(e){var r=e.ok,n=e.data,a=e.msg;r?t.$router.replace("/transaction_buy/".concat(n.orderId,"?m=").concat(t.isCryptoMerchant?1:0)):t.$toast.fail(a)})):this.$toast.fail("请选择支付账号"):this.$toast.fail("请选择支付方式"):this.$toast.fail("请输入购买数额")},loadOrderInfo:function(t){var e=this;(0,u.Hn)({pendingOrderId:t},this.BuyerApiPath).then((function(t){var r=t.ok,n=t.msg,a=t.data;if(r){a.isSplit||(e.form.amount=a.validAmount),e.orderInfo=a;var o=function(){e.sellerPayments.forEach((function(t){e.$root.validPayments[t]&&(e.form.paymentType=t)})),e.form.paymentType||e.warnning()};e.$root.isBindAnyPayment?o():e.$root.loadPayments().then((function(t){var e=t.ok;return e&&o()}))}else e.$toast.fail(n)}))},warnning:function(){var t=this;this.$dialog.confirm({message:"您还未绑定该支付方式的支付账号,请绑定对应支付账号后再选择该支付方式",confirmButtonText:"去绑定",showCancelButton:!0,beforeClose:function(e,r){"confirm"===e&&t.$router.replace("/add_payment"),r()}})}}},p=f,y=r(1001),v=(0,y.Z)(p,n,a,!1,null,null,null),h=v.exports},54025:function(t,e,r){r.d(e,{$Z:function(){return a},$i:function(){return c},CI:function(){return y},Ej:function(){return h},Hn:function(){return l},N8:function(){return v},R9:function(){return b},XW:function(){return C},_H:function(){return o},_d:function(){return g},an:function(){return f},cf:function(){return m},dF:function(){return d},fW:function(){return u},l$:function(){return I},uF:function(){return i},v1:function(){return s},vi:function(){return p},y6:function(){return T}});var n=r(95426),a=function(t){return(0,n.q)({url:"/Api/Market/PendingOrder/myPendingOrderList",method:"POST",data:t})},o=function(t,e){return(0,n.q)({url:"/Api/Market/".concat((0,n.Dr)(e),"PendingOrder/marketPendingOrderList"),method:"POST",data:t})},i=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,n.q)({url:e?"/Api/User/Business/getOrderList":"/Api/Market/Order/myOrderList",method:e?"POST":"GET",data:t})},s=function(t,e){return(0,n.q)({url:"/Api/Market/".concat((0,n.Dr)(e),"Sell/index"),method:"POST",data:t})},c=function(t,e){return(0,n.q)({url:"/Api/Market/".concat((0,n.Dr)(e),"Sell/recycle"),method:"POST",data:t})},u=function(t,e){return(0,n.q)({url:"/Api/Market/".concat((0,n.Dr)(e),"Order/myOrderDetail"),method:"GET",data:t})},l=function(t,e){return(0,n.q)({url:"/Api/Market/".concat((0,n.Dr)(e),"PendingOrder/marketPendingOrderDetail"),method:"POST",data:t})},d=function(t,e){return(0,n.q)({url:"/Api/Market/".concat((0,n.Dr)(e),"Order/getCurrentOrderStatus"),method:"GET",data:t})},m=function(t,e){return(0,n.q)({url:"/Api/Market/".concat((0,n.Dr)(e),"PendingOrder/myPendingOrderDetail"),method:"GET",data:t})},f=function(t,e){return(0,n.q)({url:"/Api/Market/".concat((0,n.Dr)(e),"Order/buyerCreatesOrder"),method:"POST",data:t})},p=function(t,e){return(0,n.q)({url:"/Api/Market/".concat((0,n.Dr)(e),"PendingOrder/getOrderListByPendingOrder"),method:"GET",data:t})},y=function(t,e){return(0,n.q)({url:"/Api/Market/".concat((0,n.Dr)(e),"Order/sellerRefusesToCreateOrder"),method:"POST",data:t})},v=function(t,e){return(0,n.q)({url:"/Api/Market/".concat((0,n.Dr)(e),"Order/sellerConfirmsToCreateOrder"),method:"POST",data:t})},h=function(t,e){return(0,n.q)({url:"/Api/Market/".concat((0,n.Dr)(e),"Order/sellerHasNotReceivedPayment"),method:"POST",data:t})},C=function(t,e){return(0,n.q)({url:"/Api/Market/".concat((0,n.Dr)(e),"Order/sellerCompletesOrder"),method:"POST",data:t})},g=function(t,e){return(0,n.q)({url:"/Api/Market/".concat((0,n.Dr)(e),"Order/buyerCancelsOrder"),method:"POST",data:t})},I=function(t,e){return(0,n.q)({url:"/Api/Market/".concat((0,n.Dr)(e),"Order/buyerConfirmsOrderHasBeenPaid"),method:"POST",data:t})},b=function(t,e){return(0,n.q)({url:"/Api/Market/".concat((0,n.Dr)(e),"Order/buyerAppeals"),method:"POST",data:t})},T=function(t,e){return(0,n.q)({url:"/Api/Market/".concat((0,n.Dr)(e),"Order/getCancelsOrderDailyCount"),method:"GET",data:t})}},89828:function(t,e,r){r.d(e,{RY:function(){return l},VM:function(){return d},fN:function(){return u},mi:function(){return m}});var n=r(49749),a=r(52336),o=r(39873),i=(r(56977),r(54678),r(32564),r(83040),r(12879)),s=r(75461),c=["ok","data","msg"],u={data:function(){return{cryptoAccountInfo:{address:"",otcTicker:""}}},methods:{businessGetAccountInfo:function(t){var e=this;return(0,o.Z)(regeneratorRuntime.mark((function r(){var o,s,u,l,d;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,(0,i.bb)({type:t});case 2:return o=r.sent,s=o.ok,u=o.data,l=o.msg,d=(0,a.Z)(o,c),s?(e.cryptoAccountInfo=u,e.updateQRcode()):e.$toast(l),r.abrupt("return",(0,n.Z)({ok:s,data:u,msg:l},d));case 9:case"end":return r.stop()}}),r)})))()},updateQRcode:function(t){s.toDataURL(t||this.cryptoAccountInfo.address).then((function(t){var e=document.querySelector(".QRcode");e&&e.setAttribute("src",t)}))}}},l={computed:{isCryptoMerchant:function(){return"1"===this.$route.query.m},amICryptoMerchant:function(){return 1===this.$root.userInfo.BusinessStatus},ApiPath:function(){return this.isCryptoMerchant?"Business":""},BuyerApiPath:function(){return this.isCryptoMerchant&&this.amICryptoMerchant?"Business":""}}},d={data:function(){return{countdown:0,orderType:"TronDeposit",form:{paymentType:"",amount:""},orderInfo:{userId:null,paymentType:"",amount:"",passageType:"",receivingAddress:"",copeAmount:0,createDate:"",status:"",createTime:"",updateTime:"",orderId:0,orderNo:""}}},computed:{isTrading:function(){return!!this.orderInfo.orderId}},created:function(){this.getDepositDetail(this.isBuyVb)},methods:{getDepositDetail:function(){var t=arguments,e=this;return(0,o.Z)(regeneratorRuntime.mark((function r(){var n,a,o,s,c,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=t.length>0&&void 0!==t[0]&&t[0],r.next=3,(0,i.IA)({orderType:e.orderType});case 3:a=r.sent,o=a.ok,s=a.data,c=a.msg,o?s&&(e.$set(e,"orderInfo",s.order),e.form.amount=n?s.order.amount:s.order.copeAmount,e.form.paymentType=s.order.paymentType,e.cryptoAccountInfo.address=s.order.receivingAddress,e.cryptoAccountInfo.otcTicker=parseFloat(String(s.order.amount/s.order.copeAmount)).toFixed(2),e.updateQRcode(),s.currentStateExpireTime&&(s.currentStateExpireTime.expire?(e.countdown=1e3*s.currentStateExpireTime.expire-e.$root.getServerTime(),e.countdown>0&&(u=setTimeout((function(){return e.getDepositDetail(n)}),5e3),e.$once("hook:beforeDestroy",(function(){return clearTimeout(u)})))):e.countdown=0)):e.$toast(c);case 8:case"end":return r.stop()}}),r)})))()}}},m={computed:{isMerchant:function(){return"1"===this.$route.query.m||"merchant"===this.$route.params.type},hideAlipayWechat:function(){return this.isMerchant&&!this.$root.isMerchantAlipayWechatOpen},hideAlipayWechatAtMerchantPage:function(){return!this.$root.isMerchantAlipayWechatOpen},payments:function(){return this.isMerchant?this.$root.merchantPayments:this.$root.payments}}}}}]);
//# sourceMappingURL=5205.2b540977.js.map