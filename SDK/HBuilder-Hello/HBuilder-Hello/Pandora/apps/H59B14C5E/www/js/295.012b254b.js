"use strict";(self["webpackChunkez_pay"]=self["webpackChunkez_pay"]||[]).push([[295],{47804:function(t,e,n){n.d(e,{Z:function(){return c}});var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"level"},t._l(5,(function(e){var r;return n("div",{key:e,staticClass:"grade mini",class:(r={},r["g"+t.largeLevel+((5==e?0==t.levelModel:t.levelModel>=e||0==t.levelModel)?"l":"")]=!0,r)})})),0)},a=[],o=(n(9653),{name:"Level",props:{level:{type:Number,default:1}},computed:{levelModel:function(){return this.level%5},largeLevel:function(){return this.levelModel>=1?(this.level-this.levelModel)/5+1:this.level/5}}}),i=o,u=n(1001),s=(0,u.Z)(i,r,a,!1,null,null,null),c=s.exports},55074:function(t,e,n){n.d(e,{Z:function(){return c}});var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"virtual-payment",on:{click:function(e){return t.$emit("click")}}},[n("div",{staticClass:"icon",class:t.type}),n("div",{staticClass:"info"},["ali"==t.type?n("div",[t._v("支付宝账号："+t._s(t._f("safeText")(t.alipayAccount)))]):t._e(),"wechat"==t.type?n("div",[t._v("微信真实姓名："+t._s(t._f("safeText")(t.wxRealname)))]):t._e(),n("div",[t._v("姓名："+t._s(t._f("safeRealName")(t.realName)))])]),n("van-image",{staticClass:"qr",attrs:{src:t.$root.getImageUrl(t.receiptCode)}}),t._t("default")],2)},a=[],o={name:"VirtualPayment",props:{type:String,realName:String,wxRealname:String,alipayAccount:String,receiptCode:String}},i=o,u=n(1001),s=(0,u.Z)(i,r,a,!1,null,null,null),c=s.exports},50295:function(t,e,n){n.r(e),n.d(e,{default:function(){return b}});var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page page-sale"},[n("div",{staticClass:"top-wrapper"},[n("div",{staticClass:"merchant"},[n("div",{staticClass:"left"},[n("van-image",{staticClass:"avatar",attrs:{src:t.$root.getImageUrl(t.$root.userInfo.avatar),fit:"cover",round:""}}),n("div",{staticClass:"seller-info"},[n("div",{staticClass:"name"},[t._v(t._s(t.$root.userInfo.nickname))]),n("Level",{attrs:{level:this.$root.userInfo.creditLevel}})],1)],1),n("div",{staticClass:"right"},[n("div",{staticClass:"label"},[t._v("可出售总额（V币）")]),n("div",{staticClass:"amount"},[t._v(" "+t._s(parseFloat(t.balance).toFixed(2))+" ")])])])]),n("van-form",{on:{submit:t.handlerSubmit}},[n("van-field",{attrs:{autocomplete:"new-password",label:"出售数量：",placeholder:"最低出售数量为"+t.minimumSellAmount+"V币",type:"number"},model:{value:t.form.amount,callback:function(e){t.$set(t.form,"amount",e)},expression:"form.amount"}}),t.form.isSplit?n("van-field",{attrs:{autocomplete:"new-password",label:"最低购买：",placeholder:t.minimumBuyAmountPlaceholder,type:"number"},model:{value:t.form.minBuyEach,callback:function(e){t.$set(t.form,"minBuyEach",e)},expression:"form.minBuyEach"}}):t._e(),n("van-collapse",{model:{value:t.form.paymentType,callback:function(e){t.$set(t.form,"paymentType",e)},expression:"form.paymentType"}},[n("van-checkbox-group",{model:{value:t.form.paymentType,callback:function(e){t.$set(t.form,"paymentType",e)},expression:"form.paymentType"}},[n("van-cell-group",{attrs:{title:"请选择收款方式"}},[t._l(t.localPayments,(function(e,r){return[("ali"===r||"wechat"===r?t.showAlipayWechatForMerchantWhenItsOn:"usdt"!==r)?n("van-collapse-item",{key:r,staticClass:"payment",attrs:{disabled:0===e.list.length,name:e.type,title:0===e.list.length?"未绑定该收款方式":e.typeName,clickable:""},scopedSlots:t._u([{key:"icon",fn:function(){return[n("div",{staticClass:"payment-icon",class:r})]},proxy:!0},{key:"right-icon",fn:function(){return[n("van-checkbox",{attrs:{disabled:0===e.list.length,name:e.type,shape:"square"}})]},proxy:!0}],null,!0)},[n("van-radio-group",{model:{value:t.form.payments[r],callback:function(e){t.$set(t.form.payments,r,e)},expression:"form.payments[k]"}},[t._l(e.list,(function(a,o){return[e.type===t.PAYMENT_METHOD.BANK?[n("van-cell",{key:o,staticClass:"paymentChannel",attrs:{title:t.$root.banksIdMappingName[a.bankId],value:t._f("safeBankNumber")(a.bankNo),clickable:""},on:{click:function(e){t.form.payments[r]=a.id}},scopedSlots:t._u([{key:"right-icon",fn:function(){return[n("van-radio",{attrs:{name:a.id}})]},proxy:!0}],null,!0)})]:[n("VirtualPayment",t._b({key:o,attrs:{type:r},on:{click:function(e){t.form.payments[r]=a.id}}},"VirtualPayment",a,!1),[n("van-radio",{staticStyle:{"margin-left":"15px"},attrs:{name:a.id}})],1)]]}))],2)],1):t._e()]}))],2)],1)],1),n("van-cell-group",{staticClass:"split",attrs:{border:!1,title:"是否拆分"}},[n("van-radio-group",{model:{value:t.form.isSplit,callback:function(e){t.$set(t.form,"isSplit",e)},expression:"form.isSplit"}},[t.hideSeparately?t._e():n("van-radio",{staticClass:"btn",attrs:{name:1}},[n("div",{staticClass:"btn",attrs:{slot:"icon"},slot:"icon"},[t._v("可拆分")])]),n("van-radio",{staticClass:"btn",attrs:{name:0}},[n("div",{staticClass:"btn",attrs:{slot:"icon"},slot:"icon"},[t._v("不可拆分")])])],1)],1),n("van-button",{staticClass:"block primary",attrs:{"native-type":"submit"}},[t._v(" 发布挂单 ")])],1)],1)},a=[],o=n(37174),i=n(39873),u=n(19934),s=(n(83040),n(89554),n(41539),n(54747),n(70189),n(78783),n(33948),n(47941),n(83710),n(39714),n(69600),n(57327),n(21249),n(69720),n(9653),n(85827),n(86947)),c=n(54025),l=n(12879),m=n(47804),f=n(55074),p=n(39766),d=n(89828),h={components:{Level:m.Z,VirtualPayment:f.Z},mixins:[d.RY,d.mi],data:function(){return{PAYMENT_METHOD:s.hL,collapse:"",form:{amount:"",minBuyEach:"",paymentType:[],isSplit:1,payments:{}},sellingConfig:{wechatAlipayAmountMin:{min:10,max:1e4},wechatAlipayAmountMiddle:{min:10001,max:3e4},wechatAlipayAmountMax:{min:30001,max:6e4},bankCardAmountMin:{min:33,max:1e4},bankCardAmountMiddle:{min:10003,max:3e4},bankCardAmountMax:{min:30001,max:6e4}}}},computed:{showAlipayWechatForMerchantWhenItsOn:function(){return!this.isMerchant||this.$root.isMerchantAlipayWechatOpen},localPayments:function(){var t={};for(var e in this.payments)(!this.hideAlipayWechat||"ali"!==e&&"wechat"!==e)&&(t[e]=this.payments[e]);return t},paymentsMappingIds:function(){var t={};for(var e in this.payments){var n=this.payments[e];t[n.type]=n.list}return t},balance:function(){return this.isCryptoMerchant?this.$root.cryptoMerchantInfo.businessBalance:this.$root.userInfo.validSellBalance},matchPaymentConfig:function(){var t=this.sellingConfig,e=t.wechatAlipayAmountMin,n=t.bankCardAmountMin,r=[],a=!1,o=!1;(this.form.paymentType||[]).forEach((function(t){t!==s.hL.WE_CHAT&&t!==s.hL.ALI||(a=!0),t===s.hL.BANK&&(o=!0)})),a&&r.push(e),o&&r.push(n);var i=null;return r.forEach((function(t){null===i&&(i=t),t.min>i.min&&(i=t)})),i},hideSeparately:function(){return!!(this.form.amount&&this.matchPaymentConfig&&this.form.amount<=2*this.matchPaymentConfig.min)&&(this.form.isSplit=0,!0)},minimumSellAmount:function(){return this.matchPaymentConfig&&this.isCryptoMerchant?this.matchPaymentConfig.min:10},minimumBuyAmount:function(){return this.matchPaymentConfig&&this.isCryptoMerchant?this.matchPaymentConfig.min:0},minimumBuyAmountPlaceholder:function(){return this.minimumBuyAmount?"最低购买数量为".concat(this.minimumBuyAmount,"V币"):"请填写买家最低可购买数量"}},watch:{"form.paymentType":function(t,e){var n,r=new Set(e),a=(0,u.Z)(t);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(!r.has(o)){this.form.payments[o===s.hL.BANK?"bank":o===s.hL.ALI?"ali":"wechat"]=this.paymentsMappingIds[o][0].id;break}}}catch(f){a.e(f)}finally{a.f()}var i,c=new Set(t),l=(0,u.Z)(e);try{for(l.s();!(i=l.n()).done;){var m=i.value;if(!c.has(m)){this.form.payments[m===s.hL.BANK?"bank":m===s.hL.ALI?"ali":"wechat"]="";break}}}catch(f){l.e(f)}finally{l.f()}},"form.isSplit":function(){this.form.minBuyEach=""}},created:function(){this.isCryptoMerchant&&this.getBusinessConfig(),this.$root.loadPayments(),this.loadPayments(),this.$root.$emit("root:set-topbar",["left-back","customer-service"])},methods:{loadPayments:function(){var t=this,e=function(){Object.keys(t.payments).forEach((function(e){t.$set(t.form.payments,e,"")}))};this.$root.isBindAnyPayment?e():this.$root.loadPayments().then((function(t){var n=t.ok;return n&&e()}))},getBusinessConfig:function(){var t=this;return(0,i.Z)(regeneratorRuntime.mark((function e(){var n,r,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,l.cf)();case 2:n=e.sent,r=n.ok,a=n.data,o=n.msg,r?t.sellingConfig=a.amount_range_config:t.$toast(o);case 7:case"end":return e.stop()}}),e)})))()},handlerSubmit:function(){var t=this;return(0,i.Z)(regeneratorRuntime.mark((function e(){var n,r,a,i,u,l,m;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=Object.entries(t.form.payments).map((function(t){var e=(0,o.Z)(t,2),n=(e[0],e[1]);return n})).filter((function(t){return t>0})).join(",").toString(),!(t.form.amount<10)){e.next=3;break}return e.abrupt("return",t.$toast.fail("最低出售量为10"));case 3:if(!(t.form.amount>Number(t.balance))){e.next=5;break}return e.abrupt("return",t.$toast.fail("出售量不得高于可售数量"));case 5:if(n.length){e.next=7;break}return e.abrupt("return",t.$toast.fail("请选择支付方式"));case 7:if(r=!0,t.form.paymentType.forEach((function(e){return e===s.hL.BANK&&0===t.payments.bank.list.length||e===s.hL.ALI&&0===t.payments.ali.list.length||e===s.hL.WE_CHAT&&0===t.payments.wechat.list.length?t.paymentVerifyFlag=!1:void 0})),r){e.next=11;break}return e.abrupt("return",t.$toast.fail("请选择支付账户"));case 11:if(!t.form.isSplit||t.form.minBuyEach){e.next=13;break}return e.abrupt("return",t.$toast.fail("请输入最低购买数量"));case 13:if(!(t.form.isSplit&&t.form.minBuyEach.toNumber()>t.form.amount.toNumber())){e.next=15;break}return e.abrupt("return",t.$toast.fail("最低购买量不得高于出售量"));case 15:if(!(t.isCryptoMerchant&&t.form.amount<t.minimumBuyAmount)){e.next=17;break}return e.abrupt("return",t.$toast.fail("最低出售数量为".concat(t.minimumBuyAmount,"V币")));case 17:if(!(t.isCryptoMerchant&&t.form.amount<t.minimumSellAmount)){e.next=19;break}return e.abrupt("return",t.$toast.fail("最低出售数量为".concat(t.minimumSellAmount,"V币")));case 19:return e.next=21,(0,p.x)(t);case 21:if(a=e.sent,!a||6!==a.length){e.next=44;break}return e.next=25,(0,p.D)(t);case 25:if(i=e.sent,i){e.next=28;break}return e.abrupt("return");case 28:return e.next=30,(0,c.v1)(t.$tls.processParams({amount:Number(t.form.amount),minBuyEach:Number(t.form.minBuyEach),paymentType:t.form.paymentType.reduce((function(t,e){return Number(t)+Number(e)}),0).toString(),paymentTypeId:n,isSplit:t.form.isSplit.toString(),maxBuyEach:Number(t.form.amount),sign:"",securePassword:a},["float","shake"]),t.ApiPath);case 30:if(u=e.sent,l=u.ok,m=u.msg,!l){e.next=43;break}if(t.$root.fetchUserInfo(),!t.isCryptoMerchant){e.next=39;break}return e.next=38,t.$router.back(-1);case 38:return e.abrupt("return",e.sent);case 39:return e.next=41,t.$router.push("my_hang_orders");case 41:e.next=44;break;case 43:t.$toast.fail(m);case 44:case"end":return e.stop()}}),e)})))()}}},y=h,v=n(1001),g=(0,v.Z)(y,r,a,!1,null,null,null),b=g.exports},54025:function(t,e,n){n.d(e,{$Z:function(){return a},$i:function(){return s},CI:function(){return h},Ej:function(){return v},Hn:function(){return l},N8:function(){return y},R9:function(){return A},XW:function(){return g},_H:function(){return o},_d:function(){return b},an:function(){return p},cf:function(){return f},dF:function(){return m},fW:function(){return c},l$:function(){return k},uF:function(){return i},v1:function(){return u},vi:function(){return d},y6:function(){return C}});var r=n(95426),a=function(t){return(0,r.q)({url:"/Api/Market/PendingOrder/myPendingOrderList",method:"POST",data:t})},o=function(t,e){return(0,r.q)({url:"/Api/Market/".concat((0,r.Dr)(e),"PendingOrder/marketPendingOrderList"),method:"POST",data:t})},i=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,r.q)({url:e?"/Api/User/Business/getOrderList":"/Api/Market/Order/myOrderList",method:e?"POST":"GET",data:t})},u=function(t,e){return(0,r.q)({url:"/Api/Market/".concat((0,r.Dr)(e),"Sell/index"),method:"POST",data:t})},s=function(t,e){return(0,r.q)({url:"/Api/Market/".concat((0,r.Dr)(e),"Sell/recycle"),method:"POST",data:t})},c=function(t,e){return(0,r.q)({url:"/Api/Market/".concat((0,r.Dr)(e),"Order/myOrderDetail"),method:"GET",data:t})},l=function(t,e){return(0,r.q)({url:"/Api/Market/".concat((0,r.Dr)(e),"PendingOrder/marketPendingOrderDetail"),method:"POST",data:t})},m=function(t,e){return(0,r.q)({url:"/Api/Market/".concat((0,r.Dr)(e),"Order/getCurrentOrderStatus"),method:"GET",data:t})},f=function(t,e){return(0,r.q)({url:"/Api/Market/".concat((0,r.Dr)(e),"PendingOrder/myPendingOrderDetail"),method:"GET",data:t})},p=function(t,e){return(0,r.q)({url:"/Api/Market/".concat((0,r.Dr)(e),"Order/buyerCreatesOrder"),method:"POST",data:t})},d=function(t,e){return(0,r.q)({url:"/Api/Market/".concat((0,r.Dr)(e),"PendingOrder/getOrderListByPendingOrder"),method:"GET",data:t})},h=function(t,e){return(0,r.q)({url:"/Api/Market/".concat((0,r.Dr)(e),"Order/sellerRefusesToCreateOrder"),method:"POST",data:t})},y=function(t,e){return(0,r.q)({url:"/Api/Market/".concat((0,r.Dr)(e),"Order/sellerConfirmsToCreateOrder"),method:"POST",data:t})},v=function(t,e){return(0,r.q)({url:"/Api/Market/".concat((0,r.Dr)(e),"Order/sellerHasNotReceivedPayment"),method:"POST",data:t})},g=function(t,e){return(0,r.q)({url:"/Api/Market/".concat((0,r.Dr)(e),"Order/sellerCompletesOrder"),method:"POST",data:t})},b=function(t,e){return(0,r.q)({url:"/Api/Market/".concat((0,r.Dr)(e),"Order/buyerCancelsOrder"),method:"POST",data:t})},k=function(t,e){return(0,r.q)({url:"/Api/Market/".concat((0,r.Dr)(e),"Order/buyerConfirmsOrderHasBeenPaid"),method:"POST",data:t})},A=function(t,e){return(0,r.q)({url:"/Api/Market/".concat((0,r.Dr)(e),"Order/buyerAppeals"),method:"POST",data:t})},C=function(t,e){return(0,r.q)({url:"/Api/Market/".concat((0,r.Dr)(e),"Order/getCancelsOrderDailyCount"),method:"GET",data:t})}},39766:function(t,e,n){n.d(e,{D:function(){return i},x:function(){return o}});var r=n(39873),a=(n(83040),n(41539),n(32564),n(53045)),o=function(t){return t.$toast("请输入资金密码"),new Promise((function(e,n){t.$root.showPassowordKeyboard=!0,t.$root.$once("root:global-password",function(){var t=(0,r.Z)(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",e(n));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}))},i=function(t){return t.$root.userInfo&&t.$root.userInfo.isGoogleAuthenticator?(t.$toast("请输入Google安全码"),new Promise((function(e,n){setTimeout((function(){t.$root.showPassowordKeyboard=!0,t.$root.$once("root:global-password",function(){var n=(0,r.Z)(regeneratorRuntime.mark((function n(r){var o,i,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r&&"close-by-route-change"!==r){n.next=2;break}return n.abrupt("return",e(!1));case 2:return n.next=4,(0,a.Wg)({safeCode:r});case 4:o=n.sent,i=o.ok,u=o.msg,i?e(!0):(e(!1),t.$toast.fail(u));case 8:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}())}),0)}))):Promise.resolve(!0)}},89828:function(t,e,n){n.d(e,{RY:function(){return l},VM:function(){return m},fN:function(){return c},mi:function(){return f}});var r=n(49749),a=n(52336),o=n(39873),i=(n(56977),n(54678),n(32564),n(83040),n(12879)),u=n(75461),s=["ok","data","msg"],c={data:function(){return{cryptoAccountInfo:{address:"",otcTicker:""}}},methods:{businessGetAccountInfo:function(t){var e=this;return(0,o.Z)(regeneratorRuntime.mark((function n(){var o,u,c,l,m;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,i.bb)({type:t});case 2:return o=n.sent,u=o.ok,c=o.data,l=o.msg,m=(0,a.Z)(o,s),u?(e.cryptoAccountInfo=c,e.updateQRcode()):e.$toast(l),n.abrupt("return",(0,r.Z)({ok:u,data:c,msg:l},m));case 9:case"end":return n.stop()}}),n)})))()},updateQRcode:function(t){u.toDataURL(t||this.cryptoAccountInfo.address).then((function(t){var e=document.querySelector(".QRcode");e&&e.setAttribute("src",t)}))}}},l={computed:{isCryptoMerchant:function(){return"1"===this.$route.query.m},amICryptoMerchant:function(){return 1===this.$root.userInfo.BusinessStatus},ApiPath:function(){return this.isCryptoMerchant?"Business":""},BuyerApiPath:function(){return this.isCryptoMerchant&&this.amICryptoMerchant?"Business":""}}},m={data:function(){return{countdown:0,orderType:"TronDeposit",form:{paymentType:"",amount:""},orderInfo:{userId:null,paymentType:"",amount:"",passageType:"",receivingAddress:"",copeAmount:0,createDate:"",status:"",createTime:"",updateTime:"",orderId:0,orderNo:""}}},computed:{isTrading:function(){return!!this.orderInfo.orderId}},created:function(){this.getDepositDetail(this.isBuyVb)},methods:{getDepositDetail:function(){var t=arguments,e=this;return(0,o.Z)(regeneratorRuntime.mark((function n(){var r,a,o,u,s,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.length>0&&void 0!==t[0]&&t[0],n.next=3,(0,i.IA)({orderType:e.orderType});case 3:a=n.sent,o=a.ok,u=a.data,s=a.msg,o?u&&(e.$set(e,"orderInfo",u.order),e.form.amount=r?u.order.amount:u.order.copeAmount,e.form.paymentType=u.order.paymentType,e.cryptoAccountInfo.address=u.order.receivingAddress,e.cryptoAccountInfo.otcTicker=parseFloat(String(u.order.amount/u.order.copeAmount)).toFixed(2),e.updateQRcode(),u.currentStateExpireTime&&(u.currentStateExpireTime.expire?(e.countdown=1e3*u.currentStateExpireTime.expire-e.$root.getServerTime(),e.countdown>0&&(c=setTimeout((function(){return e.getDepositDetail(r)}),5e3),e.$once("hook:beforeDestroy",(function(){return clearTimeout(c)})))):e.countdown=0)):e.$toast(s);case 8:case"end":return n.stop()}}),n)})))()}}},f={computed:{isMerchant:function(){return"1"===this.$route.query.m||"merchant"===this.$route.params.type},hideAlipayWechat:function(){return this.isMerchant&&!this.$root.isMerchantAlipayWechatOpen},hideAlipayWechatAtMerchantPage:function(){return!this.$root.isMerchantAlipayWechatOpen},payments:function(){return this.isMerchant?this.$root.merchantPayments:this.$root.payments}}}}}]);
//# sourceMappingURL=295.012b254b.js.map